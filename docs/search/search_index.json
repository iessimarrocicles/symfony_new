{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Curs de Symfony","text":"<p>Benvinguts al curs de Symfony, un dels frameworks PHP m\u00e9s potents i utilitzats per al desenvolupament d\u2019aplicacions web modernes.</p>"},{"location":"#1-objectius-del-curs","title":"1. Objectius del curs","text":"<p>En aquest curs aprendrem a desenvolupar aplicacions web en entorn servidor utilitzant el framework Symfony, treballant amb els seus principals components i bones pr\u00e0ctiques de programaci\u00f3.</p>"},{"location":"#2-continguts-principals","title":"2. Continguts principals","text":"<p>Al llarg del curs anirem aprofundint en els seg\u00fcents temes:</p> <ol> <li> <p>Introducci\u00f3 a Symfony    Qu\u00e8 \u00e9s un framework PHP i per qu\u00e8 triem Symfony com a base per al desenvolupament web.</p> </li> <li> <p>El patr\u00f3 MVC    Comprendre l\u2019estructura Model\u2013Vista\u2013Controlador i com Symfony la implementa.</p> </li> <li> <p>Plantilles amb Twig    Separar la l\u00f2gica del disseny amb el motor de plantilles Twig.</p> </li> <li> <p>El contenidor de serveis i la injecci\u00f3 de depend\u00e8ncies    Entendre com Symfony gestiona els serveis i la seua reutilitzaci\u00f3 en tota l\u2019aplicaci\u00f3.</p> </li> <li> <p>Model de dades amb Doctrine    Definir entitats i gestionar la persist\u00e8ncia de dades amb l\u2019ORM Doctrine.</p> </li> <li> <p>Formularis i validaci\u00f3    Crear i validar formularis de manera estructurada i segura.</p> </li> <li> <p>Seguretat i control d\u2019acc\u00e9s    Configurar l\u2019autenticaci\u00f3 i autoritzaci\u00f3 d\u2019usuaris.</p> </li> <li> <p>Bundles i extensi\u00f3 del framework    Afegir funcionalitats mitjan\u00e7ant bundles i paquets.</p> </li> <li> <p>Desplegament d\u2019aplicacions Symfony    Preparar i publicar aplicacions Symfony en servidors o plataformes cloud.</p> </li> </ol>"},{"location":"#3-requisits-previs","title":"3. Requisits previs","text":"<p>Per a seguir el curs \u00e9s recomanable tindre coneixements b\u00e0sics de:</p> <ul> <li>PHP orientat a objectes</li> <li>HTML, CSS i JavaScript</li> <li>SQL i gestors de bases de dades com MySQL o MariaDB.</li> </ul> <p>\ud83c\udfaf Objectiu final: al final del curs ser\u00e0s capa\u00e7 de crear una aplicaci\u00f3 web completa, estructurada i segura, desenvolupada amb Symfony i seguint les bones pr\u00e0ctiques del desenvolupament professional.</p>"},{"location":"Practica1/","title":"\ud83d\udcbb TEMA 1 \u2014 Pr\u00e0ctica","text":"<p>Objectiu</p> <p>En aquesta pr\u00e0ctica crearem un projecte inicial. Per aix\u00f2, haur\u00e0s de tindre operativa la m\u00e0quina virtual amb XAMPP i Composer instal\u00b7lats.</p>"},{"location":"Practica1/#exercici-1","title":"Exercici 1","text":"<p>Creaci\u00f3 del projecte inicial</p> <ul> <li>Crea un nou projecte Symfony anomenat <code>tendaNomAlumne</code>, que anirem completant posteriorment, dins de la carpeta de treball:   <pre><code>/var/www/html/symfony\n</code></pre>   Aquest projecte partir\u00e0 d'un esquelet m\u00ednim i els components b\u00e0sics <code>orm</code>, <code>twig</code>, <code>twig-bundle</code>, <code>asset</code> i <code>asset-mapper</code>.</li> </ul> <ul> <li>Modifica el fitxer <code>/etc/hosts</code> i afegeix una entrada per a crear un Virtual Host, de manera que pugues accedir al projecte mitjan\u00e7ant la seg\u00fcent adre\u00e7a:   <pre><code>http://symfony.tendaNomAlumne\n</code></pre></li> </ul> <ul> <li>Inicia un repositori Git del teu projecte.   <pre><code>git init\ngit add .\ngit commit -m \"Commit Inicial Tenda Alumne\"\n</code></pre></li> </ul>"},{"location":"Practica1/#explicacio","title":"Explicaci\u00f3","text":"<p>Quan pugem un projecte PHP a GitHub, la carpeta vendor no es puja perqu\u00e8 est\u00e0 exclosa mitjan\u00e7ant .gitignore. Aquesta carpeta cont\u00e9 totes les depend\u00e8ncies gestionades per Composer, i per tant, no s\u2019ha de versionar.</p> <p>Carpeta vendor no inclosa al repositori</p> <p>Per aix\u00f2, si descarreguem el projecte en un altre ordinador o entorn de treball, la carpeta vendor no existir\u00e0.</p> <p>En eixe cas, \u00e9s necessari reinstal\u00b7lar totes les depend\u00e8ncies executant la seg\u00fcent instrucci\u00f3 dins de la carpeta del projecte:</p> <pre><code>composer install\n</code></pre> <p>Aquesta ordre:</p> <ul> <li>Llegix el fitxer composer.json.</li> <li>Descarrega totes les llibreries necess\u00e0ries.</li> <li>Reconstrueix la carpeta vendor.</li> </ul>"},{"location":"Practica2/","title":"\ud83d\udcbb TEMA 2 \u2014 Pr\u00e0ctica","text":"<p>Objectiu</p> <p>En aquesta pr\u00e0ctica treballarem amb el patr\u00f3 MVC a Symfony, creant els primers controladors i rutes personalitzades dins del projecte <code>tendaNomAlumne</code>.</p> <p>Punt de partida</p> <p>Partim de l\u2019aplicaci\u00f3 <code>tendaNomAlumne</code> creada en la pr\u00e0ctica anterior.  </p>"},{"location":"Practica2/#exercici-1","title":"Exercici 1","text":"<p>Creaci\u00f3 de controladors b\u00e0sics</p> <p>Afegeix dins de la carpeta <code>src/Controller</code> els seg\u00fcents controladors:</p>"},{"location":"Practica2/#controlador-inicicontroller","title":"Controlador IniciController","text":"<ol> <li>Crea una classe anomenada <code>IniciController</code>.</li> <li>Afig un m\u00e8tode anomenat <code>inici</code>, associat a la ruta arrel <code>/</code>.</li> <li>Dona-li el nom de ruta <code>inici</code>.</li> <li>Mostra com a resposta el missatge seg\u00fcent:</li> </ol> <pre><code>Projecte Gesti\u00f3 Tenda de [nom i cognoms de l'alumne]\n</code></pre>"},{"location":"Practica2/#controlador-secciocontroller","title":"Controlador SeccioController","text":"<ol> <li>Crea una classe anomenada <code>SeccioController</code>.</li> <li>Afig un m\u00e8tode anomenat <code>seccio</code>, associat a la ruta <code>/seccio/{codi}</code>.</li> <li>Dona-li el nom de ruta <code>dades_seccio</code>.</li> <li>El par\u00e0metre <code>{codi}</code> ser\u00e0 un n\u00famero identificatiu d\u2019una secci\u00f3.</li> </ol> <p>A la mateixa classe, declara un array amb quatre seccions, cadascuna amb els seg\u00fcents camps:</p> <ul> <li><code>codi</code></li> <li><code>nom</code></li> <li><code>descripcio</code></li> <li><code>any</code></li> <li><code>articles</code> (array amb quatre noms d\u2019articles)</li> </ul> <p>Exemple orientatiu de secci\u00f3:</p> <pre><code>array(\n    \"codi\" =&gt; \"1\",\n    \"nom\" =&gt; \"Roba\",\n    \"descripcio\" =&gt; \"Secci\u00f3 de roba\",\n    \"any\" =&gt; \"2026\",\n    \"articles\" =&gt; array(\"Pantalons\", \"Camisa\", \"Jersei\", \"Jaqueta\")\n)\n</code></pre> <p>El controlador ha de buscar la secci\u00f3 que coincidisca amb el codi rebut per par\u00e0metre:</p> <ul> <li>Si la troba, mostrar\u00e0 totes les seues dades en el format que preferisques (text pla o HTML).</li> <li>Si no la troba, mostrar\u00e0 el missatge:</li> </ul> <pre><code>No s\u2019ha trobat la secci\u00f3: CodiSeccio\n</code></pre>"},{"location":"Practica2/#exercici-2","title":"Exercici 2","text":"<p>Control de Versions</p> <p>Una vegada hages finalitzat les modificacions, treballerem amb el control de versions:</p> <ul> <li>Afegeix els fitxers canviats a l\u2019\u00e0rea de preparaci\u00f3 (staging area) de Git.</li> <li>Crea un commit amb el missatge.</li> <li>Crea una etiqueta (tag).</li> </ul> <pre><code># 1. Afegir tots els canvis a l\u2019\u00e0rea de preparaci\u00f3\ngit add --all\n\n# 2. Crear el commit amb el missatge indicat\ngit commit -m \"Commit MVC TendaNomAlumne\"\n\n# 3. Crear l\u2019etiqueta (tag) v2.0 amb comentari\ngit tag -a v2.0 -m \"Versi\u00f3 2.0 TendaNomAlumne MVC\"\n\n# 4. Pujar tant el commit com l\u2019etiqueta al repositori remot\ngit push origin master --tags\n</code></pre> <p>Amb aix\u00f2, quedaran registrats tant l\u2019estat final del projecte com la marca de versi\u00f3 corresponent.</p>"},{"location":"Practica2/#utilitat-etiqueta-tag","title":"Utilitat etiqueta (tag)","text":"<p>Una etiqueta en Git \u00e9s com posar un marcador en un punt concret de la hist\u00f2ria del projecte.</p> <p>Normalment s\u2019utilitza per:</p> <ol> <li> <p>Identificar versions importants del programari, com ara:</p> <ul> <li>v1.0</li> <li>v1.1</li> <li>v2.0</li> </ul> </li> <li> <p>Poder tornar a eixa versi\u00f3 en qualsevol moment per a revisar el codi, restaurar-lo o comparar canvis.</p> </li> <li> <p>Distribuir o entregar treball amb una versi\u00f3 estable i final.</p> </li> <li> <p>Per llistar les etiquetes existents:     <pre><code>git tag\n</code></pre></p> </li> </ol>"},{"location":"Practica2/#treballant-amb-lhistorial","title":"Treballant amb l'historial","text":"<p>Per mostrar l'historial:</p> <pre><code>git log\n\ngit log --oneline\n\n# Vista per veure branques i posicions HEAD\ngit log --graph --abbrev-commit --decorate --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all\n</code></pre>"},{"location":"Practica2/#versions-anteriors","title":"Versions anteriors","text":"<p>Per tornar a una versi\u00f3 anterior identificada per una etiqueta o hash.</p> <p>Opci\u00f3 1. Nom\u00e9s consultar o executar el codi d\u2019eixa versi\u00f3 (sense modificar res)</p> <pre><code># Identifacada per una etiqueta\ngit checkout v2.0\n\n# Identificada per un hash de un commit\ngit checkout 1bcb819\n</code></pre> <ul> <li>Pots mirar el codi, compilar-lo, executar-lo, etc.</li> <li>Per\u00f2 si fas commits ac\u00ed, no estaran associats a cap branca.</li> </ul> <p>Pots tornar a la versi\u00f3 incial:</p> <pre><code># Per veure la rama on estas\ngit branch\n\n# Per tornar a la versi\u00f3 inicial\ngit checkout master\n</code></pre> <p>Opci\u00f3 2. Crear una branca nova a partir del tag (per continuar treballant des d\u2019eixa versi\u00f3)</p> <pre><code>git checkout -b nova_versio2.0 v2.0\n</code></pre> <ul> <li>Aix\u00f2 crea una branca nova anomenada <code>nova_versio2.0</code> basada en eixe tag, i ja pots fer commits amb normalitat.</li> </ul> <p>Opci\u00f3 3. Reposicionar la branca actual a eixa versi\u00f3 (tornar enrere \u201cde veritat\u201d)</p> <pre><code>git reset --hard v2.0\n</code></pre> <ul> <li>Aix\u00f2 canviar\u00e0 l\u2019historial si fas push despr\u00e9s.</li> </ul>"},{"location":"Practica2/#resultat-final-esperat","title":"Resultat final esperat","text":"<ul> <li>El projecte mostra correctament la p\u00e0gina d\u2019inici i les seccions.</li> <li>El codi segueix el patr\u00f3 MVC.</li> </ul>"},{"location":"Practica3/","title":"\ud83d\udcbb TEMA 3 \u2014 Pr\u00e0ctica","text":"<p>Objectiu</p> <p>Aprendre a crear i utilitzar plantilles Twig per generar vistes din\u00e0miques a Symfony, reutilitzant components i aplicant bones pr\u00e0ctiques en la construcci\u00f3 de la interf\u00edcie.</p> <p>Punt de partida</p> <p>Partim de l\u2019aplicaci\u00f3 <code>tendaNomAlumne</code> creada i configurada en les pr\u00e0ctiques anteriors.</p> <p>Estructura final</p> <pre><code>projecte/\n\u251c\u2500 assets/\n\u2502  \u251c\u2500 styles/, imgs/, imgs/seccio/\n\u2502  \u2514\u2500 app.js\n\u2514\u2500 src/\n\u2502  \u251c\u2500 Controller/IniciController.php\n\u2502  \u2514\u2500 Controller/SeccioController.php\n\u2514\u2500 templates/\n   \u251c\u2500 partials/\n   \u2502  \u251c\u2500 _menu.html.twig\n   \u2502  \u251c\u2500 _peu.html.twig\n   \u251c\u2500 seccio/\n   \u2502  \u251c\u2500 detall.html.twig\n   \u2502  \u2514\u2500 llistat.html.twig\n   \u251c\u2500 base.html.twig\n   \u2514\u2500 inici.html.twig\n</code></pre>"},{"location":"Practica3/#exercici-1","title":"Exercici 1","text":"<p>En aquest exercici tens dues opcions de disseny per comen\u00e7ar a treballar amb Bootstrap:</p> <ul> <li>Opci\u00f3 A: Utilitzar una plantilla Bootstrap ja creada (desc\u00e0rrega d\u2019un portal).<ul> <li>Bootstrap Made </li> <li>Theme Wagon </li> </ul> </li> <li>Opci\u00f3 B: Crear la teua pr\u00f2pia plantilla base amb Bootstrap, amb men\u00fa principal i peu de p\u00e0gina.</li> </ul> <p>Pots triar lliurement entre aquestes dues opcions segons el teu nivell o prefer\u00e8ncies. L\u2019objectiu \u00e9s treballar amb una base Bootstrap funcional i estructurada que servir\u00e0 per a les vistes Twig posteriors.</p> <p>Requisits generals:</p> <ol> <li>Crea un fitxer <code>base.html.twig</code> amb una estructura HTML senzilla que incloga:<ul> <li>Un men\u00fa principal amb almenys un element de tipus dropdown.</li> <li>Un cos principal per al contingut.</li> <li>Un peu de p\u00e0gina amb informaci\u00f3 b\u00e0sica (autor, any, enlla\u00e7os legals...).</li> </ul> </li> <li>Importa Bootstrap des d\u2019un CDN o mitjan\u00e7ant els fitxers locals.</li> <li>Assegura\u2019t que la teua plantilla siga responsive i que els estils es mostren correctament.</li> </ol>"},{"location":"Practica3/#exercici-2","title":"Exercici 2","text":"<ol> <li>A partir del fitxer <code>base.html.twig</code>, defineix les seccions principals amb blocs Twig (<code>{% block ... %}</code>) per a:<ul> <li><code>title</code></li> <li><code>stylesheets</code></li> <li><code>contingut</code></li> <li><code>javascripts</code></li> </ul> </li> <li>Importa en aquesta plantilla tots els recursos CSS i JS que necessite la plantilla Bootstrap triada (o creada per tu).</li> <li>Crea una carpeta <code>templates/_fragments</code> i extrau com a m\u00ednim:<ol> <li><code>_menu.html.twig</code> -&gt; men\u00fa de navegaci\u00f3.</li> <li><code>_peu.html.twig</code> -&gt; peu de p\u00e0gina.</li> </ol> </li> <li>A partir de la plantilla base, crea una subplantilla d\u2019inici (<code>inici.html.twig</code>) que herete de la base i mostre:<ul> <li>El nom del projecte.</li> <li>Un breu text de presentaci\u00f3.</li> <li>Una imatge o element visual destacat.</li> </ul> </li> <li>Modifica el controlador <code>src/Controller/IniciController.php</code>:<ul> <li>Ha de renderitzar <code>inici.html.twig</code>.</li> </ul> </li> </ol> <p>Per concatenar valors en Twig s\u2019utilitza el s\u00edmbol <code>~</code>.</p>"},{"location":"Practica3/#exercici-3","title":"Exercici 3","text":"<ol> <li>Crea una carpeta <code>templates/seccions</code>:<ol> <li>Llistat <code>templates/seccio/llistat.html.twig</code> : taula responsive amb codi, nom, descripci\u00f3, any i nombre d'articles i un enlla\u00e7 \"Veure\" en fer clic, s'obrir\u00e0 la p\u00e0gina de les dades d\u2019eixa secci\u00f3 en concret (utilitzant el nom de la ruta corresponent).</li> <li>Detall <code>templates/seccio/detall.html.twig</code> : cap\u00e7alera amb una imatge i dades; grid de targetes d'articles. Afig un enlla\u00e7 amb una imatge per tornar al llistat de seccions.</li> </ol> </li> <li>Controlador i rutes de seccions:<ul> <li>Classe <code>src/Controller/SeccioController.php</code>:<ul> <li>llistat():<ul> <li>Ruta <code>/seccions</code>.</li> <li>Nom <code>llistat_seccions</code>.</li> <li>Renderitza <code>seccio/llistat.html.twig</code>.</li> </ul> </li> <li>detall(int $codi):<ul> <li>Ruta <code>/seccions/{codi}</code>.</li> <li>Nom <code>dades_seccio</code>.</li> <li>Renderitza <code>seccio/detall.html.twig</code>.</li> </ul> </li> </ul> </li> </ul> </li> </ol> <p>Les rutes m\u00ednimes del nostre projecte: <code>inici</code>, <code>llistat_seccions</code> i <code>dades_seccio</code>.</p> <p>Podem comprovar el funcionament amb <code>php bin/console debug:router</code> i el profiler.</p>"},{"location":"Practica3/#exercici-4","title":"Exercici 4","text":"<p>Control de Versions</p> <ol> <li>Quan tot funcione, fes un commit amb Git:</li> </ol> <pre><code>git add --all\ngit commit -m \"Tema 3: Plantilles TWIG\"\ngit tag -a v3.0 -m \"Versi\u00f3 3.0 TendaNomAlumne Plantilles &lt;TWIG&gt;\"\ngit push origin master --tags\n</code></pre>"},{"location":"Practica3/#resultat-final-esperat","title":"Resultat final esperat","text":"<ul> <li>L\u2019aplicaci\u00f3 utilitza plantilles Twig per a totes les vistes.</li> <li>La navegaci\u00f3 entre p\u00e0gines funciona correctament mitjan\u00e7ant rutes Symfony.</li> <li>S\u2019han aplicat estils Bootstrap a les vistes.</li> </ul>"},{"location":"Practica4/","title":"\ud83d\udcbb TEMA 4 \u2014 Pr\u00e0ctica","text":"<p>Objectiu</p> <p>Treballar amb el contenidor de serveis de Symfony i aplicar el concepte d\u2019injecci\u00f3 de depend\u00e8ncies per a gestionar dades i recursos dins de l\u2019aplicaci\u00f3.</p> <p>Punt de partida</p> <p>Partim de l\u2019aplicaci\u00f3 <code>tendaNomAlumne</code> creada i configurada en les pr\u00e0ctiques anteriors.</p>"},{"location":"Practica4/#exercici-1","title":"Exercici 1","text":"<p>Revis\u00f3 r\u00e0pida del contenidor i autowiring</p> <ol> <li>Obri <code>config/services.yaml</code> i localitza els defaults:    <pre><code>services:\n  _defaults:\n    autowire: true\n    autoconfigure: true\n    public: false\n</code></pre>    Aix\u00f2 habilita que Symfony detecte i injecte autom\u00e0ticament les depend\u00e8ncies per tipus (classes/interf\u00edcies), i registre serveis segons el seu tipus.</li> </ol>"},{"location":"Practica4/#exercici-2","title":"Exercici 2","text":"<p>\u00das b\u00e0sic de LoggerInterface en un controlador</p> <ol> <li>Edita el fitxer <code>src/Controller/IniciController.php</code> i injecta LoggerInterface al constructor de la classe. <ul> <li>Fes que cada vegada que un usuari accedisca a la p\u00e0gina d\u2019inici (/), es guarde un registre amb la data, l\u2019adre\u00e7a IP i l\u2019URL visitada.</li> </ul> </li> <li>Entra a http://symfony.tendaNomAlumne/ i comprova que s\u2019ha creat o actualitzat el fitxer <code>var/log/dev.log</code>. Hauries de veure una l\u00ednia semblant a:    <pre><code>[info] Nou acc\u00e9s d\u2019usuari: {\"ip\":\"127.0.0.1\",\"moment\":\"2025-11-12 09:30:00\",\"ruta\":\"/\"}\n</code></pre></li> <li>Obri el fitxer de log i verifica que cada vegada que recarregues la p\u00e0gina, s\u2019afegeix un nou registre d\u2019acc\u00e9s.</li> </ol> <p>\ud83d\udca1 Si el m\u00e8tode del controlador rep com a par\u00e0metre un objecte Request, Symfony l\u2019injecta autom\u00e0ticament i pots consultar-hi dades de la petici\u00f3 (IP, URI, etc.).</p>"},{"location":"Practica4/#exercici-3","title":"Exercici 3","text":"<p>Servei propi <code>DadesSeccioServei</code></p> <p>Crea un servei anomenat <code>DadesSeccioServei</code> dins de la carpeta <code>src/Service</code> (si no existeix, crea-la primer). Aquest servei s\u2019encarregar\u00e0 de gestionar totes les dades relacionades amb les seccions, incloent ara tamb\u00e9 la imatge identificadora de cadascuna.</p> <ol> <li> <p>Trasllat de dades:</p> <ul> <li>Copia l\u2019array de seccions que fins ara estava declarat dins de <code>src/Controller/SeccioController</code>.</li> <li>Porta\u2019l al nou servei <code>DadesSeccioServei</code>, on quedar\u00e0 com una propietat privada de la classe.</li> <li>Afig a l'array un nou camp anomenat <code>imatge</code> per cada secci\u00f3:<ul> <li>Descarrega una imatge representativa o un logo per a cada secci\u00f3 (roba, cal\u00e7at...).</li> <li>Guarda-les a la carpeta <code>asset/imgs/seccions/</code> del projecte.</li> <li>Assegura\u2019t que els noms dels fitxers siguen senzills i sense espais (roba.jpg, calcat.jpg...).</li> </ul> </li> </ul> </li> <li> <p>M\u00e8todes p\u00fablics:</p> <ul> <li>Defineix un m\u00e8tode <code>llistarSeccions()</code> que retorne tot l\u2019array de seccions.</li> <li>Afig tamb\u00e9 un m\u00e8tode <code>obtenirSeccioPerCodi(int $codi)</code> que, donat un codi, retorne la secci\u00f3 corresponent o <code>null</code> si no existeix.</li> </ul> </li> <li> <p>\u00das del servei en els controladors:</p> <ul> <li>En <code>src/Controller/SeccioController</code>, elimina l\u2019array local i injecta el nou servei <code>DadesSeccioServei</code> mitjan\u00e7ant el constructor. Substitueix totes les crides a l\u2019array per les crides als m\u00e8todes del servei (<code>llistarSeccions()</code> i <code>obtenirSeccioPerCodi()</code>).</li> </ul> </li> <li> <p>Mostrar les imatges en les plantilles Twig</p> <ul> <li>A la vista de la secci\u00f3 <code>detall.html.twig</code>, mostra la imatge utilitzant la funci\u00f3 asset de Twig i l\u2019operador de concatenaci\u00f3 ~.<ul> <li>Exemple: <code>{{ asset('img/' ~ seccio.imatge) }}</code> (no \u00e9s la soluci\u00f3, nom\u00e9s una pista sint\u00e0ctica).</li> </ul> </li> </ul> </li> </ol> <p>Amb aquest canvi, el teu projecte utilitzar\u00e0 un servei centralitzat per gestionar les dades de seccions, millorant la modularitat i mantenibilitat del codi.</p>"},{"location":"Practica4/#exercici-4","title":"Exercici 4","text":"<p>Control de Versions</p> <ol> <li>Quan tot funcione, fes un commit amb Git:</li> </ol> <pre><code>git add --all\ngit commit -m \"Tema 4: Contenidor de Serveis\"\ngit tag -a v4.0 -m \"Versi\u00f3 4.0 TendaNomAlumne Contenidor de Serveis\"\ngit push origin master --tags\n</code></pre>"},{"location":"Practica4/#resultat-final-esperat","title":"Resultat final esperat","text":"<ul> <li>Controlador que utilitza serveis predefinits com <code>LoggerInterface</code>.  </li> <li>Registres al fitxer <code>var/log/dev.log</code>.</li> <li>Generar un servei propi <code>DadesSeccioServei</code>  amb m\u00e8todes per llistar i obtenir una seccio.</li> <li>Controlador que utilitza un servei propi, el esmentat al punt anterior.</li> <li>Mostrar imatges a les vistes de Twig.</li> </ul>"},{"location":"Practica5/","title":"\ud83d\udcbb TEMA 5 \u2014 Pr\u00e0ctica","text":"<p>Objectiu</p> <p>Aquest tema tracta sobre com gestionar el model de dades en Symfony utilitzant Doctrine ORM, incloent la creaci\u00f3 d\u2019entitats, relacions i operacions amb la base de dades.</p> <p>Punt de partida</p> <p>Partim de l\u2019aplicaci\u00f3 <code>tendaNomAlumne</code> creada i configurada en les pr\u00e0ctiques anteriors.</p>"},{"location":"Practica5/#exercici-1","title":"Exercici 1","text":"<p>Creaci\u00f3 de la Base de Dades i Entitat Seccio</p> <p>Configurar la connexi\u00f3 a la base de dades i crear l\u2019entitat dins l\u2019aplicaci\u00f3.</p> <ol> <li> <p>Defineix la variable d\u2019entorn DATABASE_URL al fitxer <code>.env</code>:</p> </li> <li> <p>Crea la base de dades.</p> </li> <li> <p>Genera la nova entitat Seccio.</p> </li> <li> <p>Afegeix els seg\u00fcents camps:</p> <ul> <li><code>nom</code> (string, 50)</li> <li><code>descripcio</code> (string, 255)</li> <li><code>any</code> (integer)</li> <li><code>imatge</code> (string, 100)</li> </ul> </li> <li> <p>Genera la migraci\u00f3 i aplica-la.</p> </li> </ol>"},{"location":"Practica5/#exercici-2","title":"Exercici 2","text":"<p>Inserci\u00f3 de seccions des del Controlador</p> <ol> <li> <p>Afegeix un nou m\u00e8tode <code>afegir</code> al controlador <code>SeccioController</code> per inserir totes les seccions.</p> </li> <li> <p>Crea la plantilla <code>templates/seccio/afegir.html.twig</code> per mostrar el resultat.</p> </li> <li> <p>Crea la plantilla <code>templates/seccio/error.html.twig</code> per mostrar el resultat en cas d'error.</p> </li> <li> <p>Afegeix un enlla\u00e7 en el men\u00fa de la plantilla principal <code>_menu.html.twig</code> per accedir a <code>/seccions/afegir</code>.</p> </li> </ol>"},{"location":"Practica5/#exercici-3","title":"Exercici 3","text":"<p>Entitat Article amb Relaci\u00f3 ManyToOne a Seccio</p> <p>Crear una nova entitat Article relacionada amb Seccio (Molts a Un).</p> <ol> <li> <p>Genera l\u2019entitat corresponent.</p> </li> <li> <p>Afegeix els camps:</p> <ul> <li><code>nom</code> (string, 100)</li> <li><code>preu</code> (float)</li> <li><code>stock</code> (integer)</li> <li><code>imatge</code> (string, 255)</li> <li><code>seccio</code> (relaci\u00f3 ManyToOne amb Seccio)<ul> <li>Quan l\u2019assistent ens pregunta si volem afegir una propietat en la classe Seccio per poder accedir als seus articles des del codi. En este cas, acceptem la proposta escrivint yes i definim el nom de la nova propietat com articles. Aix\u00f2 ens fara una relaci\u00f3 bidireccional. D\u2019esta manera es genera autom\u00e0ticament una relaci\u00f3 bidireccional: la classe Article tindr\u00e0 la propietat seccio, i la classe Seccio disposar\u00e0 d\u2019una col\u00b7lecci\u00f3 articles amb els m\u00e8todes getArticles(), addArticle() i removeArticle().</li> </ul> </li> </ul> </li> <li> <p>Genera i executa la migraci\u00f3.</p> </li> </ol>"},{"location":"Practica5/#exercici-4","title":"Exercici 4","text":"<p>Inserci\u00f3 d\u2019un article amb relaci\u00f3</p> <ol> <li> <p>Afegeix un nou controlador <code>ArticleController.php</code> per inserir articles.</p> </li> <li> <p>Crea la plantilla <code>templates/article/afegir.html.twig</code> per mostrar el resultat.</p> </li> <li> <p>Crea la plantilla <code>templates/article/error.html.twig</code> per mostrar el resultat en cas d'error.</p> </li> <li> <p>Afegeix un enlla\u00e7 en el men\u00fa de la plantilla principal <code>_menu.html.twig</code> per accedir a <code>/articles/afegir</code>.</p> </li> </ol>"},{"location":"Practica5/#exercici-5","title":"Exercici 5","text":"<p>Modificar les vistes perqu\u00e8 utilitzen dades reals de la base de dades</p> <ol> <li> <p>Actualitza totes les vistes i controladors que encara utilitzen el servei antic DadesSeccioServei.php (creat en el tema anterior).</p> </li> <li> <p>Substitueix les crides al servei per consultes reals a Doctrine mitjan\u00e7ant el repositori de Seccio i Article.</p> </li> <li> <p>Revisa totes les plantilles Twig per assegurar que:</p> <ul> <li>Les dades que es mostren provenen dels objectes Seccio i Article recuperats amb Doctrine.</li> <li>Ja no s'utilitzen arrays ni llistes simulades.</li> </ul> </li> </ol>"},{"location":"Practica5/#exercici-6","title":"Exercici 6","text":"<p>Control de Versions</p> <ol> <li>Quan tot funcione, fes un commit amb Git:</li> </ol> <pre><code>git add --all\ngit commit -m \"Tema 5: Doctrine\"\ngit tag -a v5.0 -m \"Versi\u00f3 5.0 TendaNomAlumne Doctrine\"\ngit push origin master --tags\n</code></pre>"},{"location":"Practica5/#resultat-final-esperat","title":"Resultat final esperat","text":"<ul> <li>Configurar Doctrine i crear la base de dades.</li> <li>Generar l\u2019entitat Seccio i aplicar migracions.</li> <li>Inserir dades des del controlador i mostrar-les amb Twig.</li> <li>Crear l\u2019entitat Article i establir una relaci\u00f3 bidireccional ManyToOne amb Seccio.</li> <li>Inserir articles vinculats a seccions existents.</li> <li>Afegir enlla\u00e7os al men\u00fa per facilitar la navegaci\u00f3.</li> <li>Totes les vistes i controladors deixen d\u2019utilitzar el servei temporal del Tema 4, mostrant informaci\u00f3 real guardada en MySQL.</li> </ul>"},{"location":"Tema1/","title":"\ud83d\udcd8 TEMA 1 \u2014 Introducci\u00f3 a Symfony","text":""},{"location":"Tema1/#1-que-es-un-framework","title":"1. Qu\u00e8 \u00e9s un framework?","text":"<p>Un framework \u00e9s una eina que proporciona un conjunt d\u2019elements i regles per a facilitar el desenvolupament d\u2019aplicacions web.  </p> <p>En el cas dels frameworks PHP, ofereixen:</p> <ul> <li>Una estructura de treball predefinida (normalment basada en el patr\u00f3 MVC).  </li> <li>Eines per a crear i gestionar models de dades, controladors i vistes.  </li> <li>Suport per a rutes, injecci\u00f3 de depend\u00e8ncies, seguretat i testejos autom\u00e0tics.  </li> </ul> <p>Aix\u00f2 permet que el codi siga m\u00e9s organitzat, modular i f\u00e0cil de mantindre.</p>"},{"location":"Tema1/#2-exemples-de-frameworks-php","title":"2. Exemples de frameworks PHP","text":"<p>Actualment hi ha molts frameworks PHP disponibles, entre els que destaquem:</p> Framework Any Caracter\u00edstiques principals Laravel 2011 Elegant, simple i amb gran comunitat. Ideal per a projectes nous. Symfony 2005 Molt estructurat, modular i estable. Segueix bones pr\u00e0ctiques de programaci\u00f3. CodeIgniter 2006 Lleuger i r\u00e0pid d\u2019aprendre, per\u00f2 m\u00e9s limitat. Phalcon 2012 Extremadament r\u00e0pid i flexible, pot funcionar com a microframework. CakePHP 2005 Senzill i amb una comunitat \u00e0mplia. Zend 2006 Robust i orientat a empreses, encara que menys utilitzat hui dia. <p>\u27a1\ufe0f Tots ells segueixen el patr\u00f3 MVC i permeten el desenvolupament tant de webs completes com de crear APIs RESTful.</p>"},{"location":"Tema1/#3-quin-triar","title":"3. Quin triar?","text":"<p>Dep\u00e9n de les necessitats del projecte i de l\u2019experi\u00e8ncia de l\u2019equip:</p> <ul> <li>Projectes senzills o d\u2019aprenentatge: CodeIgniter o CakePHP.  </li> <li>Projectes professionals o de llarga duraci\u00f3: Symfony o Laravel.  </li> </ul> <p>\ud83e\udde0 Symfony \u00e9s m\u00e9s complex al principi, per\u00f2 proporciona una base s\u00f2lida i escalable.</p>"},{"location":"Tema1/#4-per-que-triar-symfony","title":"4. Per qu\u00e8 triar Symfony?","text":"<p>Symfony \u00e9s un framework modern, segur i molt complet. Els seus principals avantatges s\u00f3n:</p> <ul> <li>\ud83e\uddf1 Estructura robusta i modular. </li> <li>\ud83d\udd53 Versions LTS (Long Term Support) amb manteniment garantit.  </li> <li>\ud83c\udf0d Gran comunitat i documentaci\u00f3 oficial excel\u00b7lent.  </li> <li>\ud83d\udca1 Bones pr\u00e0ctiques integrades, seguint est\u00e0ndards PSR.  </li> <li>\ud83d\udd0c Integraci\u00f3 amb llibreries de tercers com:<ul> <li>Twig \u2192 motor de plantilles per a generar vistes.</li> <li>Doctrine \u2192 ORM per a treballar amb bases de dades com a objectes.</li> </ul> </li> </ul>"},{"location":"Tema1/#5-recursos-necessaris","title":"5. Recursos necessaris","text":"<p>Abans de veure els recursos anem a veure el calendari de les diferents versi\u00f3ns de Symfony:</p> <p>Per treballar amb Symfony 6.4 o superior, cal tindre instal\u00b7lats els seg\u00fcents components:</p> Component Descripci\u00f3 Sistema operatiu Ubuntu 22.04 (recomanat) o Windows amb WSL2 Servidor web Apache o Nginx amb suport per a PHP 8.1+ Base de dades MariaDB o MySQL PHP Versi\u00f3 8.1 o posterior Composer Gestor de depend\u00e8ncies per a PHP Symfony CLI Eina oficial per a crear i gestionar projectes IDE / Editor VS Code, PHPStorm o qualsevol altre amb suport per a PHP"},{"location":"Tema1/#6-conceptes-basics","title":"6. Conceptes b\u00e0sics","text":"<ul> <li>Patr\u00f3 MVC: separa la l\u00f2gica del programa en tres parts:<ul> <li>Model: dades i connexions amb la BD (Doctrine).</li> <li>Vista: interf\u00edcie que veu l\u2019usuari (Twig).</li> <li>Controlador: gestiona la l\u00f2gica i la comunicaci\u00f3 entre model i vista.</li> </ul> </li> <li>Bundles: m\u00f2duls o extensions que afegeixen funcionalitats.</li> <li>Injecci\u00f3 de depend\u00e8ncies: forma de compartir recursos sense acoblar les classes.</li> <li>Entorn de desenvolupament: dev, prod, test, definit al fitxer .env.</li> </ul>"},{"location":"Tema1/#7-primers-passos-amb-symfony","title":"7. Primers passos amb Symfony","text":"<p>Abans de comen\u00e7ar a crear els nous projectes, hem de preparar l'espai de treball dins del servidor Apache. Substitueix <code>usuari</code> pel teu nom d'usuari a la m\u00e0quina virtual.</p> <pre><code>cd /var/www/html\nsudo mkdir symfony\nsudo chown -R usuari:usuari symfony\ncd symfony\n</code></pre>"},{"location":"Tema1/#71-projecte-complet","title":"7.1. Projecte complet","text":"<p>Creaci\u00f3 d'un nou projecte com una web completa (recomanada per aplicacions web \u201cclassiques\u201d)</p> <pre><code>symfony new nom_projecte --webapp\ncd nom_projecte\n</code></pre> <p>Instal\u00b7la directament:</p> <ul> <li>Twig</li> <li>Doctrine</li> <li>Security</li> <li>Mailer</li> <li>Routing</li> <li>Altres paquets b\u00e1sics del framework.</li> </ul> <p>\ud83d\udca1 \u00c9s la manera moderna i substitueix els antics esquelets (<code>website-skeleton</code> i <code>symfony/skeleton</code>).</p>"},{"location":"Tema1/#72-projecte-minim","title":"7.2. Projecte m\u00ednim","text":"<p>Creaci\u00f3 d'un nou projecte m\u00ednim (ideal per a APIs o microserveis)</p> <pre><code>symfony new nom_projecte\ncd nom_projecte\n\n# Afegir manualment els components que necessites\ncomposer require orm\ncomposer require twig\ncomposer require symfony/twig-bundle\ncomposer require symfony/asset\ncomposer require symfony/asset-mapper\ncomposer require symfony/maker-bundle --dev\n</code></pre> <p>\ud83e\udde0 Diferencia principal:</p> <ul> <li>L'opcio <code>--webapp</code> instal\u00b7la tots els paquets essencials d'entrada.  </li> <li>El projecte minim nomes inclou el nucli de Symfony, i tu vas afegint els components segons el que necessites.</li> </ul> <p>Projecte de proves</p> <p>Al llarg de les explicacions te\u00f2riques crearem un projecte m\u00ednim anomenat agenda, que utilitzarem exclusivament per a fer proves i exemples de classe. </p> <p>Aquest projecte inclour\u00e0 \u00fanicament els components b\u00e0sics indicats <code>orm</code>, <code>twig</code>, <code>twig-bundle</code>, <code>asset</code> i <code>asset-mapper</code>, i ens servir\u00e0 per a entendre pas a pas el funcionament de Symfony i per consolidar els coneixements apresos.</p> <p>Projecte de pr\u00e0ctiques</p> <p>Paral\u00b7lelament, desenvoluparem un segon projecte, que servir\u00e0 com a base per a les pr\u00e0ctiques avaluables del curs.</p> <p>Aquest projecte partir\u00e0 d'un esquelet m\u00ednim i els components b\u00e0sics <code>orm</code> i <code>twig</code>. Tindreu m\u00e9s informaci\u00f3 sobre aquest projecte en les pr\u00e0ctiques espec\u00edfiques de cada tema.</p>"},{"location":"Tema1/#8-estructura-general-dun-projecte","title":"8. Estructura general d\u2019un projecte","text":"<p>Quan creem un projecte amb Symfony, s\u2019organitza autom\u00e0ticament en una estructura de carpetes molt clara i estandarditzada. Aquesta estructura ajuda a mantenir el codi ordenat i a separar la l\u00f2gica, les vistes i la configuraci\u00f3.</p>"},{"location":"Tema1/#81-estructura-principal","title":"8.1. Estructura principal","text":"<pre><code>projecte/\n\u2502\n\u251c\u2500\u2500 assets/               # Cont\u00e9 els arxius fonts d'estils, imatges...\n\u251c\u2500\u2500 bin/                  # Cont\u00e9 els scripts executables, com `console`\n\u251c\u2500\u2500 config/               # Fitxers de configuraci\u00f3 de Symfony i serveis\n\u251c\u2500\u2500 migrations/           # Fitxers de migracions de base de dades (Doctrine)\n\u251c\u2500\u2500 public/               # Carpeta p\u00fablica del servidor web (arrel del projecte)\n\u2502   \u2514\u2500\u2500 index.php           # Punt d\u2019entrada principal de l\u2019aplicaci\u00f3\n\u251c\u2500\u2500 src/                  # Codi font del projecte (controladors, entitats, serveis...)\n\u2502   \u251c\u2500\u2500 Controller/         # Controladors (gesti\u00f3 de rutes i l\u00f2gica)\n\u2502   \u251c\u2500\u2500 Entity/             # Entitats (models de dades per Doctrine)\n\u2502   \u251c\u2500\u2500 Repository/         # Classes per consultar la base de dades\n\u2502   \u2514\u2500\u2500 Service/            # Serveis personalitzats del projecte\n\u251c\u2500\u2500 templates/            # Plantilles Twig (vistes HTML)\n\u251c\u2500\u2500 translations/         # Fitxers de traduccions (si n\u2019hi ha)\n\u251c\u2500\u2500 var/                  # Fitxers temporals, cach\u00e9 i logs\n\u251c\u2500\u2500 vendor/               # Depend\u00e8ncies instal\u00b7lades amb Composer\n\u2514\u2500\u2500 .env                  # Fitxer de configuraci\u00f3 d\u2019entorn (dev/prod/test)\n</code></pre>"},{"location":"Tema1/#82-elements-mes-importants","title":"8.2. Elements m\u00e9s importants","text":"<ul> <li><code>public/</code> \u2192 \u00c9s l\u2019arrel p\u00fablica del projecte. Nom\u00e9s aquesta carpeta \u00e9s accessible des del navegador.  </li> <li><code>src/</code> \u2192 Cont\u00e9 el codi principal de l\u2019aplicaci\u00f3. \u00c9s on programem els controladors, entitats i serveis.  </li> <li><code>config/</code> \u2192 Defineix com es comporta Symfony: rutes, serveis, paquets i par\u00e0metres globals.  </li> <li><code>templates/</code> \u2192 Cont\u00e9 les vistes en format Twig.  </li> <li><code>var/</code> \u2192 Guarda fitxers generats autom\u00e0ticament: cach\u00e9, logs, etc.  </li> <li><code>vendor/</code> \u2192 Inclou totes les llibreries i depend\u00e8ncies instal\u00b7lades per Composer.  </li> <li><code>.env</code> \u2192 Defineix variables d\u2019entorn, com connexi\u00f3 a la base de dades o el mode d\u2019execuci\u00f3 (<code>dev</code>, <code>prod</code>, <code>test</code>).</li> </ul> <p>\ud83d\udca1 Consell: No modifiques directament els fitxers dins de <code>vendor/</code>. Tot el que necessites personalitzar ha d\u2019anar a <code>src/</code> o <code>config/</code>.</p>"},{"location":"Tema1/#9-full-rapid-de-comandes-utils","title":"9. Full r\u00e0pid de comandes \u00fatils","text":"<p>Comandaments ajuda:</p> <pre><code># \ud83c\udfd7\ufe0f Crear un projecte complet\nsymfony new app --webapp\n\n# \ud83d\ude80 Iniciar el servidor local\nsymfony serve -d\n\n# \ud83c\udfae Generar elements b\u00e0sics del projecte\nphp bin/console make:controller               # Crear un controlador\nphp bin/console make:entity                   # Crear una entitat\nphp bin/console make:migration                # Crear una migraci\u00f3\nphp bin/console doctrine:migrations:migrate   # Executar migracions\n\n# \ud83e\uddf0 CRUD autom\u00e0tic\nphp bin/console make:crud\n\n# \ud83d\udd10 Gesti\u00f3 d'usuaris i autenticaci\u00f3\nphp bin/console make:user\nphp bin/console make:auth\n</code></pre>"},{"location":"Tema1/#10-conclusio","title":"10. Conclusi\u00f3","text":"<p>Symfony \u00e9s una de les millors opcions per a aprendre desenvolupament web en entorn servidor amb PHP. Et permet entendre com funciona el patr\u00f3 MVC, treballar amb bones pr\u00e0ctiques i construir aplicacions professionals, segures i escalables.</p> <p>\ud83d\udcac En resum: Symfony \u00e9s exigent al principi, per\u00f2 t\u2019ensenya a programar \u201cb\u00e9\u201d.</p> <p>Refer\u00e8ncies:</p> <ul> <li>Documentaci\u00f3 oficial de Symfony</li> <li>Releases Symfony</li> </ul>"},{"location":"Tema1_Annex1/","title":"Instal\u00b7laci\u00f3 en Ubuntu","text":"<p>A continuaci\u00f3 tens una guia detallada, t\u00e8cnica i pedag\u00f2gica sobre tot all\u00f2 que cal instal\u00b7lar per poder treballar amb Symfony en una m\u00e0quina Ubuntu.</p>"},{"location":"Tema1_Annex1/#1-actualitzar-el-sistema","title":"1. Actualitzar el sistema","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre> <p>Actualitza l\u2019\u00edndex de paquets i instal\u00b7la les actualitzacions pendents. \u00c9s recomanable fer-ho abans d'instal\u00b7lar cap eina.</p>"},{"location":"Tema1_Annex1/#2-installar-php-i-extensions","title":"2. Instal\u00b7lar PHP i extensions","text":"<p>Symfony requereix una versi\u00f3 moderna de PHP (8.1 o superior). A Ubuntu sol estar disponible a trav\u00e9s del repositori <code>ondrej/php</code>.</p> <p>Afegir repositori PHP modern:</p> <pre><code>sudo add-apt-repository ppa:ondrej/php -y\nsudo apt update\n</code></pre> <p>Aix\u00f2 permet accedir a versions de PHP que no venen per defecte a Ubuntu.</p> <p>Instal\u00b7lar PHP i extensions recomanades per Symfony:</p> <pre><code>sudo apt install -y php8.2 php8.2-cli php8.2-common php8.2-mysql php8.2-xml \\\nphp8.2-mbstring php8.2-zip php8.2-intl php8.2-curl php8.2-gd php8.2-sqlite3\n</code></pre> <p>Explicaci\u00f3 de les extensions principals:</p> <ul> <li>php-cli: permet executar PHP des de terminal.</li> <li>php-mysql / php-sqlite3: connexions a bases de dades.</li> <li>php-xml: necessari per a components interns de Symfony.</li> <li>php-mbstring: gestiona cadenes multibyte.</li> <li>php-intl: internacionalitzaci\u00f3 (traduccions, formats\u2026).</li> <li>php-curl: peticions HTTP.</li> <li>php-zip: gesti\u00f3 de fitxers ZIP.</li> <li>php-gd: manipulaci\u00f3 d\u2019imatges.</li> </ul>"},{"location":"Tema1_Annex1/#3-installar-composer","title":"3. Instal\u00b7lar Composer","text":"<p>Symfony dep\u00e9n de Composer per a instal\u00b7lar paquets i eines. \u00c9s el nostre gestor de depend\u00e8ncies de PHP.</p> <p>Descarregar Composer:</p> <pre><code>php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\"\nphp composer-setup.php\nsudo mv composer.phar /usr/local/bin/composer\nsudo chmod +x /usr/local/bin/composer\n</code></pre> <p>Ara tens composer disponible globalment.</p>"},{"location":"Tema1_Annex1/#4-installar-symfony-cli","title":"4. Instal\u00b7lar Symfony CLI","text":"<p>La Symfony CLI (eina oficial) permet crear projectes, arrancar servidors locals i comprovar compatibilitat.</p> <p>Instal\u00b7laci\u00f3:</p> <pre><code>wget https://get.symfony.com/cli/installer -O - | bash\nsudo mv /home/$USER/.symfony*/bin/symfony /usr/local/bin/symfony\n</code></pre> <p>Comprovaci\u00f3:</p> <pre><code>symfony -v\n</code></pre>"},{"location":"Tema1_Annex1/#5-installar-un-servidor-web","title":"5. Instal\u00b7lar un servidor web","text":"<p>Tot i que el servidor integrat funciona b\u00e9 en desenvolupament, pots instal\u00b7lar:</p> <p>Apache:</p> <pre><code>sudo apt install apache2 libapache2-mod-php8.2\n</code></pre> <p>O b\u00e9 Nginx:</p> <pre><code>sudo apt install nginx\n</code></pre> <p>Normalment per a Symfony en producci\u00f3 es recomana Nginx per rendiment, per\u00f2 Apache \u00e9s m\u00e9s senzill per a principiants.</p>"},{"location":"Tema1_Annex1/#6-installar-una-base-de-dades","title":"6. Instal\u00b7lar una base de dades","text":"<p>Pots triar entre MySQL, MariaDB o PostgreSQL. Exemple amb MySQL:</p> <pre><code>sudo apt install mysql-server -y\nsudo mysql_secure_installation\n</code></pre> <p>Simples passos interactius milloren la seguretat: contrasenya root, eliminar usuaris an\u00f2nims, etc.</p>"},{"location":"Tema1_Annex1/#7-comprovar-compatibilitat","title":"7. Comprovar compatibilitat","text":"<p>Podem comprovar si falta alguna extensi\u00f3 de PHP o configuraci\u00f3.</p> <pre><code>symfony check:requirements\n</code></pre>"},{"location":"Tema1_Annex1/#8-validador-de-seguretat-de-dependencies","title":"8. Validador de seguretat de depend\u00e8ncies","text":"<p>Podem comprovar vulnerabilitats conegudes en paquets de Composer.</p> <pre><code>symfony security:check\n</code></pre>"},{"location":"Tema1_Annex1/#ja-pots-treballar-amb-symfony","title":"\ud83c\udf89 Ja pots treballar amb Symfony!","text":"<p>Aquesta configuraci\u00f3 \u00e9s la recomanada per a entorns docents i de desenvolupament professional.</p>"},{"location":"Tema1_Annex2/","title":"Instal\u00b7laci\u00f3 en Windows","text":"<p>Aquesta guia explica qu\u00e8 cal instal\u00b7lar en un ordinador Windows per poder treballar amb Symfony, amb un enfocament docent. Tots els passos estan pensats perqu\u00e8 l\u2019alumnat entenga per a qu\u00e8 serveix cadascun dels components.</p> <p>\ud83d\udca1 Recomanaci\u00f3 pr\u00e8via: si el teu equip ho permet, la millor experi\u00e8ncia amb Symfony en Windows sol obtindre\u2019s usant WSL2 + Ubuntu (Linux dins de Windows). Tot i aix\u00f2, ac\u00ed tamb\u00e9 tens la instal\u00b7laci\u00f3 nativa en Windows sense WSL.</p>"},{"location":"Tema1_Annex2/#0-opcio-recomanada-resum-wsl2-ubuntu","title":"0. Opci\u00f3 recomanada (resum): WSL2 + Ubuntu","text":"<p>Si vols treballar com en un servidor Linux, pots:</p> <ol> <li>Activar Subsistema de Windows per a Linux (WSL).</li> <li>Instal\u00b7lar Ubuntu des de Microsoft Store.</li> <li>Dins d\u2019Ubuntu, seguir exactament la guia d\u2019Ubuntu que ja tens preparada.</li> </ol> <p>Aix\u00f2 et d\u00f3na un entorn molt semblant a producci\u00f3. Per a \u00fas docent, per\u00f2, sovint \u00e9s suficient la instal\u00b7laci\u00f3 nativa que detallem a continuaci\u00f3.</p>"},{"location":"Tema1_Annex2/#1-installar-un-gestor-de-paquets-per-a-windows-chocolatey-opcional-pero-recomanat","title":"1. Instal\u00b7lar un gestor de paquets per a Windows (Chocolatey) (opcional per\u00f2 recomanat)","text":"<p>Chocolatey \u00e9s un gestor de paquets per a Windows semblant a <code>apt</code> en Ubuntu. Facilita molt instal\u00b7lar PHP, Git, etc.</p>"},{"location":"Tema1_Annex2/#11-obrir-powershell-com-a-administrador","title":"1.1. Obrir PowerShell com a administrador","text":"<ol> <li>Cerca PowerShell en el men\u00fa d\u2019inici.</li> <li>Clica amb bot\u00f3 dret \u2192 Executar com a administrador.</li> </ol>"},{"location":"Tema1_Annex2/#12-activar-lexecucio-de-scripts-nomes-una-vegada","title":"1.2. Activar l\u2019execuci\u00f3 de scripts (nom\u00e9s una vegada)","text":"<pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force\n</code></pre>"},{"location":"Tema1_Annex2/#13-installar-chocolatey","title":"1.3. Instal\u00b7lar Chocolatey","text":"<pre><code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;\nSet-ExecutionPolicy Bypass -Scope Process -Force;\niex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))\n</code></pre> <p>Quan acabe, tanca i torna a obrir PowerShell per assegurar que la comanda <code>choco</code> ja funciona.</p>"},{"location":"Tema1_Annex2/#2-installar-php-i-extensions-necessaries","title":"2. Instal\u00b7lar PHP i extensions necess\u00e0ries","text":"<p>Symfony necessita una versi\u00f3 moderna de PHP (8.1 o superior). Ho farem amb Chocolatey.</p>"},{"location":"Tema1_Annex2/#21-installar-php","title":"2.1. Instal\u00b7lar PHP","text":"<p>En una PowerShell amb permisos d\u2019usuari normal (no cal administrador ara):</p> <pre><code>choco install php --version=8.2.0 -y\n</code></pre> <p>Si no especifica versi\u00f3, instal\u00b7lar\u00e0 la m\u00e9s recent. L\u2019important \u00e9s que siga 8.1 o superior.</p>"},{"location":"Tema1_Annex2/#22-afegir-php-al-path-si-no-es-fa-automaticament","title":"2.2. Afegir PHP al PATH (si no es fa autom\u00e0ticament)","text":"<p>En molts casos, Chocolatey ja ho configura. Comprova:</p> <pre><code>php -v\n</code></pre> <p>Si mostra la versi\u00f3 de PHP, ja est\u00e0 correcte. Si diu que no es reconeix la comanda, caldr\u00e0 afegir manualment la carpeta de PHP a la variable d\u2019entorn PATH.</p>"},{"location":"Tema1_Annex2/#23-extensions-de-php-per-symfony","title":"2.3. Extensions de PHP per Symfony","text":"<p>En Windows, les extensions es gestionen al fitxer <code>php.ini</code>. En instal\u00b7lacions via Chocolatey solen vindre moltes activables.</p> <ol> <li>Localitza el directori de PHP, per exemple:</li> <li><code>C:\\ProgramData\\chocolatey\\bin\\php.exe</code> \u2192 normalment el PHP real \u00e9s a <code>C:\\tools\\php82</code> o similar.</li> <li>Obri el fitxer <code>php.ini</code> (si hi ha un <code>php.ini-development</code> o <code>php.ini-production</code>, copia i renombra un d\u2019ells a <code>php.ini</code>).</li> <li>Assegura\u2019t que tens actives (sense <code>;</code> al principi) l\u00ednies semblants a:</li> </ol> <pre><code>extension=mysqli\nextension=pdo_mysql\nextension=intl\nextension=mbstring\nextension=xml\nextension=curl\nextension=gd\nextension=zip\n</code></pre> <p>Per a qu\u00e8 serveixen?</p> <ul> <li>mysqli / pdo_mysql: connexi\u00f3 a MySQL/MariaDB.</li> <li>intl: internacionalitzaci\u00f3 i formats.</li> <li>mbstring: cadenes multibyte (necessari per a Symfony).</li> <li>xml: maneig de XML (algunes eines internes de Symfony).</li> <li>curl: peticions HTTP.</li> <li>gd: manipulaci\u00f3 d\u2019imatges.</li> <li>zip: descompressi\u00f3/creaci\u00f3 de fitxers ZIP.</li> </ul> <p>Despr\u00e9s de modificar <code>php.ini</code>, guarda i tanca.</p>"},{"location":"Tema1_Annex2/#3-installar-git","title":"3. Instal\u00b7lar Git","text":"<p>Git \u00e9s imprescindible per treballar amb repositoris i amb Symfony en equip.</p> <p>Amb Chocolatey:</p> <pre><code>choco install git -y\n</code></pre> <p>Comprova:</p> <pre><code>git --version\n</code></pre>"},{"location":"Tema1_Annex2/#4-installar-composer-gestor-de-dependencies-de-php","title":"4. Instal\u00b7lar Composer (gestor de depend\u00e8ncies de PHP)","text":""},{"location":"Tema1_Annex2/#41-descarregar-linstallador-oficial","title":"4.1. Descarregar l\u2019instal\u00b7lador oficial","text":"<ol> <li>Ves a la p\u00e0gina oficial de Composer (des del navegador):</li> <li>\"Download Composer\" (instal\u00b7lador per a Windows).</li> <li>Executa l\u2019instal\u00b7lador <code>.exe</code>.</li> </ol>"},{"location":"Tema1_Annex2/#42-passos-de-linstallador","title":"4.2. Passos de l\u2019instal\u00b7lador","text":"<ul> <li>Selecciona la ruta de <code>php.exe</code> (normalment la detecta sola).</li> <li>Deixa marcada l\u2019opci\u00f3 Add to PATH perqu\u00e8 pugues usar <code>composer</code> des de qualsevol terminal.</li> </ul> <p>Quan acabe la instal\u00b7laci\u00f3, comprova a PowerShell o CMD:</p> <pre><code>composer -V\n</code></pre> <p>Aix\u00f2 ha de mostrar la versi\u00f3 de Composer.</p> <p>Qu\u00e8 \u00e9s Composer? - \u00c9s el gestor de depend\u00e8ncies de PHP. - Llig el fitxer <code>composer.json</code> del projecte i instal\u00b7la/actualitza llibreries. - Symfony (framework i bundles) es distribueix a trav\u00e9s de Composer.</p>"},{"location":"Tema1_Annex2/#5-installar-symfony-cli-eina-oficial","title":"5. Instal\u00b7lar Symfony CLI (eina oficial)","text":"<p>La Symfony CLI facilita molt el treball: crear projectes, arrencar servidor local, comprovar requisits, etc.</p>"},{"location":"Tema1_Annex2/#51-descarregar-linstallador","title":"5.1. Descarregar l\u2019instal\u00b7lador","text":"<ol> <li>Ves a la p\u00e0gina oficial de Symfony CLI.</li> <li>Descarrega l\u2019instal\u00b7lador per a Windows (<code>symfony-cli_windows_amd64.exe</code> o similar).</li> <li>Executa l\u2019instal\u00b7lador i segueix els passos (normalment afegir\u00e0 <code>symfony</code> al PATH).</li> </ol>"},{"location":"Tema1_Annex2/#52-comprovar-installacio","title":"5.2. Comprovar instal\u00b7laci\u00f3","text":"<p>Obri una nova finestra de PowerShell i executa:</p> <pre><code>symfony -v\n</code></pre> <p>Si apareix la versi\u00f3, ja est\u00e0 llest.</p> <p>Per a qu\u00e8 serveix Symfony CLI? - Crear nous projectes amb esquelet complet. - Arrencar un servidor de desenvolupament r\u00e0pid. - Comprovar requisits (<code>check:requirements</code>). - Analitzar seguretat de depend\u00e8ncies (<code>security:check</code>).</p>"},{"location":"Tema1_Annex2/#6-installar-una-base-de-dades-mysql-mariadb-postgresql","title":"6. Instal\u00b7lar una base de dades (MySQL / MariaDB / PostgreSQL)","text":"<p>Per a un entorn docent i per compatibilitat amb molts exemples, \u00e9s habitual usar MySQL o MariaDB.</p>"},{"location":"Tema1_Annex2/#61-mysql-server","title":"6.1. MySQL Server","text":"<p>Opci\u00f3 A \u2013 instal\u00b7laci\u00f3 amb Chocolatey:</p> <pre><code>choco install mysql -y\n</code></pre> <p>Opci\u00f3 B \u2013 instal\u00b7lador gr\u00e0fic:</p> <ol> <li>Ves a la p\u00e0gina oficial de MySQL.</li> <li>Descarrega MySQL Installer for Windows.</li> <li>Tria <code>Developer Default</code> o <code>Server only</code> segons prefer\u00e8ncies.</li> <li>Durant la instal\u00b7laci\u00f3, configura:</li> <li>Contrasenya de l\u2019usuari <code>root</code>.</li> <li>Mode d\u2019autenticaci\u00f3 (pots deixar el per defecte).</li> </ol>"},{"location":"Tema1_Annex2/#62-verificar-i-provar","title":"6.2. Verificar i provar","text":"<ul> <li>Comprova que el servei MySQL s\u2019ha iniciat.</li> <li>Pots usar MySQL Workbench o l\u00ednia de comandes per a crear una base de dades de prova.</li> </ul> <p>Exemple:</p> <pre><code>CREATE DATABASE symfony_demo CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n</code></pre>"},{"location":"Tema1_Annex2/#7-opcional-installar-un-servidor-web-apache-o-nginx","title":"7. (Opcional) Instal\u00b7lar un servidor web: Apache o Nginx","text":"<p>Per a desenvolupament, normalment \u00e9s suficient el servidor intern de Symfony CLI. Per\u00f2 si vols simular producci\u00f3 o fer pr\u00e0ctiques de configuraci\u00f3, pots instal\u00b7lar:</p>"},{"location":"Tema1_Annex2/#71-apache-amb-chocolatey","title":"7.1. Apache amb Chocolatey","text":"<pre><code>choco install apache-httpd -y\n</code></pre> <p>Haureu de configurar despr\u00e9s el <code>DocumentRoot</code> i els <code>VirtualHost</code> perqu\u00e8 apunten al directori <code>public/</code> del projecte Symfony.</p>"},{"location":"Tema1_Annex2/#72-nginx-amb-chocolatey","title":"7.2. Nginx amb Chocolatey","text":"<pre><code>choco install nginx -y\n</code></pre> <p>Tamb\u00e9 s\u2019haur\u00e0 de configurar el <code>server</code> block perqu\u00e8 servisca el directori <code>public/</code>.</p> <p>Per a classe, moltes vegades \u00e9s m\u00e9s pr\u00e0ctic usar \u00fanicament el servidor de Symfony CLI i explicar Apache/Nginx de forma te\u00f2rica o amb una pr\u00e0ctica espec\u00edfica.</p>"},{"location":"Tema1_Annex2/#8-crear-un-projecte-symfony-des-de-windows","title":"8. Crear un projecte Symfony des de Windows","text":"<p>Un cop tens PHP, Composer i Symfony CLI, ja pots crear un projecte.</p> <p>En una carpeta de treball (per exemple <code>C:\\Users\\alumne\\Documents\\symfony</code>):</p> <pre><code>cd C:\\Users\\alumne\\Documents\nsymfony new mi_projecte --full\n</code></pre> <p>Aix\u00f2 crear\u00e0 una carpeta <code>mi_projecte</code> amb: - Estructura de directoris de Symfony (<code>config/</code>, <code>src/</code>, <code>templates/</code>, <code>public/</code>, etc.). - Fitxers <code>composer.json</code>, <code>.env</code>, etc.</p> <p>Si vols un projecte m\u00e9s lleuger:</p> <pre><code>symfony new mi_projecte\n</code></pre>"},{"location":"Tema1_Annex2/#9-configurar-la-connexio-a-la-base-de-dades","title":"9. Configurar la connexi\u00f3 a la base de dades","text":"<p>Dins de la carpeta del projecte hi ha un fitxer <code>.env</code> (i opcionalment <code>.env.local</code>). All\u00ed es configura la connexi\u00f3.</p> <p>Exemple amb MySQL local:</p> <pre><code>DATABASE_URL=\"mysql://root:contrasenya@127.0.0.1:3306/symfony_demo?serverVersion=8.0\"\n</code></pre> <ul> <li>root: usuari de la base de dades.</li> <li>contrasenya: la que hages configurat.</li> <li>symfony_demo: nom de la base de dades.</li> </ul> <p>Despr\u00e9s, pots crear l\u2019esquema amb Doctrine (si el projecte el fa servir):</p> <pre><code>php bin/console doctrine:database:create\nphp bin/console doctrine:schema:update --force\n</code></pre>"},{"location":"Tema1_Annex2/#10-iniciar-el-servidor-de-desenvolupament-de-symfony","title":"10. Iniciar el servidor de desenvolupament de Symfony","text":"<p>Des de la carpeta del projecte:</p> <pre><code>cd C:\\Users\\alumne\\Documents\\mi_projecte\nsymfony serve -d\n</code></pre> <ul> <li>L\u2019opci\u00f3 <code>-d</code> fa que el servidor s\u2019execute en segon pla (detached).</li> <li>Per veure l\u2019URL del servidor, pots fer:</li> </ul> <pre><code>symfony local:server:status\n</code></pre> <p>Normalment ser\u00e0 <code>https://127.0.0.1:8000</code> o semblant. Obri\u2019l al navegador.</p> <p>Per parar el servidor:</p> <pre><code>symfony server:stop\n</code></pre>"},{"location":"Tema1_Annex2/#11-comprovar-requisits-i-seguretat","title":"11. Comprovar requisits i seguretat","text":""},{"location":"Tema1_Annex2/#111-requisits-de-symfony","title":"11.1. Requisits de Symfony","text":"<pre><code>symfony check:requirements\n</code></pre> <p>Mostra si falta alguna extensi\u00f3 de PHP o si hi ha alguna configuraci\u00f3 incorrecta.</p>"},{"location":"Tema1_Annex2/#112-vulnerabilitats-de-seguretat-en-dependencies","title":"11.2. Vulnerabilitats de seguretat en depend\u00e8ncies","text":"<pre><code>symfony security:check\n</code></pre> <p>Comprova si les llibreries instal\u00b7lades via Composer tenen vulnerabilitats conegudes.</p>"},{"location":"Tema1_Annex2/#12-resum-per-a-lalumnat","title":"12. Resum per a l\u2019alumnat","text":"<p>Per poder treballar amb Symfony en Windows, en ess\u00e8ncia necessitem:</p> <ol> <li>PHP actualitzat (8.1+), amb extensions necess\u00e0ries.</li> <li>Composer per a gestionar les llibreries.</li> <li>Symfony CLI per crear i gestionar projectes i servidor de desenvolupament.</li> <li>Git per controlar versions del codi.</li> <li>Base de dades (MySQL/MariaDB) per a la capa de persist\u00e8ncia.</li> <li>(Opcional) Apache o Nginx si volem treballar escenaris m\u00e9s propers a producci\u00f3.</li> </ol> <p>Amb aquests elements instal\u00b7lats i configurats, l\u2019alumne/a ja pot crear projectes, generar controladors, entitats, formularis i repositoris, i comen\u00e7ar a desenvolupar aplicacions web modernes amb Symfony des de Windows.</p>"},{"location":"Tema2/","title":"\ud83d\udcd8 TEMA 2 \u2014 El patr\u00f3 MVC","text":""},{"location":"Tema2/#1-que-es-el-patro-mvc","title":"1. Qu\u00e8 \u00e9s el patr\u00f3 MVC?","text":"<p>MVC s\u00f3n les sigles de Model - Vista - Controlador, i \u00e9s el patr\u00f3 d\u2019arquitectura m\u00e9s utilitzat en el desenvolupament web.</p> <p>L\u2019objectiu \u00e9s separar les responsabilitats del codi per a aconseguir aplicacions m\u00e9s netes, modulars i f\u00e0cils de mantenir.</p> Component Descripci\u00f3 Exemple Model Gestiona les dades i la l\u00f2gica de negoci. Representa la informaci\u00f3 que utilitza l\u2019aplicaci\u00f3. Entitats de Doctrine com <code>Contacte</code>, <code>Usuari</code>, <code>Llibre</code>... Vista S\u2019encarrega de mostrar la informaci\u00f3 a l\u2019usuari (interf\u00edcie HTML). Fitxers <code>.html.twig</code> dins la carpeta <code>templates/</code> Controlador Gestiona les peticions de l\u2019usuari, interactua amb el model i tria quina vista mostrar. Classes dins <code>src/Controller/</code>"},{"location":"Tema2/#11-avantatges-del-patro-mvc","title":"1.1. Avantatges del patr\u00f3 MVC","text":"<ul> <li>Codi m\u00e9s estructurat i mantenible.  </li> <li>Facilita el treball en equip (programador \u2194 dissenyador).  </li> <li>Permet reutilitzar components i millorar la seguretat.  </li> </ul>"},{"location":"Tema2/#2-controladors-i-rutes","title":"2. Controladors i rutes","text":"<p>Un controlador \u00e9s una funci\u00f3 o m\u00e8tode PHP que rep la petici\u00f3 de l\u2019usuari, la processa i envia una resposta (una p\u00e0gina HTML, JSON, etc.).</p> <p>Els controladors:</p> <ul> <li>Es guarden dins la carpeta <code>src/Controller/</code> del projecte.</li> <li>Normalment estan dins de classes, i aquestes solen tenir el sufix <code>Controller</code> (com <code>IniciController</code>).</li> <li>Cada m\u00e8tode de la classe gestiona una ruta concreta.</li> </ul> <p>Exemple:  </p> <ul> <li>Un controlador anomenat <code>IniciController</code> pot tindre un m\u00e8tode <code>inici()</code> que mostre un missatge de benvinguda quan l\u2019usuari accedeix a la p\u00e0gina principal del web.</li> </ul> <p>Per a crear una p\u00e0gina en Symfony calen dos elements principals:</p> <ol> <li>Una ruta \u2192 defineix l\u2019URL que activar\u00e0 el controlador.  </li> <li>Un controlador \u2192 \u00e9s la classe que cont\u00e9 el codi que es vol executar.</li> </ol>"},{"location":"Tema2/#21-rutes-tradicionals-vs-rutes-amigables","title":"2.1. Rutes tradicionals vs rutes amigables","text":"<ul> <li> <p>Rutes tradicionals: S\u00f3n les que utilitzaven els antics projectes PHP, on els par\u00e0metres s\u2019enviaven per l\u2019URL amb <code>?</code>.   Exemple: <code>http://localhost/contacte.php?codi=3</code>   \ud83d\udc49 Accedeixen directament a un fitxer concret.</p> </li> <li> <p>Rutes amigables: S\u00f3n les que usa Symfony. Les dades es passen dins de la pr\u00f2pia URL, sense extensions ni par\u00e0metres visibles.   Exemple: <code>http://localhost/contacte/3</code>   \ud83d\udc49 S\u00f3n m\u00e9s netes, segures i f\u00e0cils de recordar.</p> </li> </ul> <p>En Symfony totes les rutes s\u00f3n amigables, ja que passen pel sistema de ruteig intern i no accedeixen directament als fitxers.</p>"},{"location":"Tema2/#22-exemple-basic","title":"2.2. Exemple b\u00e0sic","text":"<p>Fitxer: <code>src/Controller/IniciController.php</code></p> <pre><code>&lt;?php\nnamespace App\\Controller;\n\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Attribute\\Route;\n\nclass IniciController\n{\n    #[Route('/', name: 'inici')]\n    public function inici(): Response\n    {\n        return new Response('Benvingut/da al web de contactes');\n    }\n}\n?&gt;\n</code></pre> <p>Explicaci\u00f3:</p> <ul> <li><code>namespace App\\Controller;</code> defineix l'espai de noms dins la carpeta <code>src</code>.</li> <li><code>#[Route('/', name: 'inici')]</code> defineix la ruta <code>/</code> i el seu nom intern.</li> <li>El m\u00e8tode <code>inici()</code> retorna un objecte <code>Response</code>, que Symfony enviar\u00e0 al navegador.</li> </ul> <p>\ud83d\udd38 A partir de Symfony 6, les rutes es defineixen amb atributs <code>#[Route]</code> (no amb anotacions <code>@Route</code>, que ja \u00e9s obsolet).</p>"},{"location":"Tema2/#23-comprovar-les-rutes-de-la-nostra-aplicacio","title":"2.3. Comprovar les rutes de la nostra aplicaci\u00f3","text":"<p>Utilitzant la consola de Symfony (arxiu <code>bin/console</code> del nostre projecte) podem comprovar quines rutes hi ha actualment definides en la nostra aplicaci\u00f3, mitjan\u00e7ant aquesta instrucci\u00f3:</p> <pre><code>php bin/console debug:router\n</code></pre> <p>Aquesta ordre mostrar\u00e0 el llistat de rutes, indicant per a cadascuna:</p> <ul> <li>El nom de la ruta</li> <li>El cam\u00ed (path) associat</li> <li>El controlador i m\u00e8tode que s\u2019executar\u00e0</li> </ul> <p>A m\u00e9s de les rutes que h\u00e0gem definit nosaltres (per exemple, la nostra ruta arrel <code>/</code>), apareixeran altres rutes creades autom\u00e0ticament per Symfony per a funcions internes, com les del profiler, utilitzades per a rastrejar i obtindre detalls de les peticions realitzades durant la depuraci\u00f3.</p> <p>\u2139\ufe0f En aquest curs no entrarem en detall sobre aquestes rutes internes, ja que s\u2019utilitzen principalment per a tasques de test i depuraci\u00f3 avan\u00e7ada.</p>"},{"location":"Tema2/#3-rutes-amb-parametres","title":"3. Rutes amb par\u00e0metres","text":"<p>Podem afegir valors din\u00e0mics dins la ruta perqu\u00e8 el controlador els reba com a par\u00e0metres:</p> <pre><code>&lt;?php\n...\n\n#[Route('/contacte/{codi}', name: 'fitxa_contacte')]\npublic function fitxa(int $codi): Response\n{\n    return new Response(\"Has consultat el contacte amb codi $codi\");\n}\n...\n?&gt;\n</code></pre> <p>Quan accedim a <code>/contacte/3</code> el navegador mostrar\u00e0:</p> <pre><code>Has consultat el contacte amb codi 3\n</code></pre>"},{"location":"Tema2/#31-configurar-rutes-a-windows","title":"3.1. Configurar rutes a Windows","text":"<p>Per a que funcionen les rutes amigables en Symfony hem de generar l\u2019arxiu <code>.htaccess</code> i assegurar que <code>mod_rewrite</code> est\u00e0 activat.</p> <p>Pas 1. Generar <code>.htaccess</code> amb Apache Pack</p> <p>Obri la terminal (PowerShell) dins de la carpeta del projecte:</p> <pre><code>cd \"C:\\xampp\\htdocs\\symfony\\nom_projecte\"\n\ncomposer config extra.symfony.allow-contrib true\ncomposer require symfony/apache-pack\n</code></pre> <p>Comprova que s\u2019ha creat el fitxer: <code>C:\\xampp\\htdocs\\symfony\\nom_projecte\\public\\.htaccess</code></p> <p>Pas 2. Activar mod_rewrite en XAMPP</p> <p>Obri el fitxer: <code>C:\\xampp\\apache\\conf\\httpd.conf</code></p> <p>Localitza i descomenta (traure #):</p> <pre><code>LoadModule rewrite_module modules/mod_rewrite.so\n</code></pre> <p>Guarda i reinicia Apache des del XAMPP Control Panel.</p>"},{"location":"Tema2/#32-configurar-rutes-a-linux","title":"3.2. Configurar rutes a Linux","text":"<p>Per a que funcionen les rutes amigables en Symfony hem de generar l\u2019arxiu <code>.htaccess</code> i assegurar que <code>mod_rewrite</code> est\u00e0 activat.</p> <p>Pas 1. Generar <code>.htaccess</code> amb Apache Pack</p> <p>Situa\u2019t a la carpeta del projecte:</p> <pre><code>cd /var/www/html/symfony/nom_projecte\n\ncomposer config extra.symfony.allow-contrib true\ncomposer require symfony/apache-pack\n</code></pre> <p>Comprova que s\u2019ha creat el fitxer: <code>/var/www/html/symfony/nom_projecte/public/.htaccess</code></p> <p>Pas 2. Activar mod_rewrite en Apache</p> <p>Activa el m\u00f2dul:</p> <pre><code>sudo a2enmod rewrite\n</code></pre> <p>Reincia el servidor Apache:</p> <pre><code>sudo systemctl restart apache2\no\nsudo service apache2 restart\n</code></pre> <p>Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p>"},{"location":"Tema2/#33-rutes-amb-parametres-amb-requisits","title":"3.3. Rutes amb par\u00e0metres amb requisits","text":"<p>En Symfony, podem imposar restriccions als valors dels par\u00e0metres de la ruta utilitzant expressions regulars.  </p> <p>Aix\u00f2 es fa amb l\u2019opci\u00f3 <code>requirements:</code> dins de l\u2019atribut <code>#[Route]</code>.</p> <pre><code>&lt;?php\n\n#[Route('/contacte/{codi}', name: 'fitxa_contacte', requirements: ['codi' =&gt; '\\d+'])]\npublic function fitxa(int $codi): Response\n{\n    return new Response(\"Has consultat el contacte amb codi $codi\");\n}\n\n?&gt;\n</code></pre> <p>\ud83e\udde0 Explicaci\u00f3:</p> <ul> <li>El par\u00e0metre <code>{codi}</code> nom\u00e9s ser\u00e0 v\u00e0lid si \u00e9s un n\u00famero (<code>\\d+</code> indica un o m\u00e9s d\u00edgits).  </li> <li>Si l\u2019usuari escriu <code>/contacte/abc</code>, Symfony mostrar\u00e0 un error 404, ja que no compleix el requisit.  </li> <li>Es poden definir diversos requisits per a diferents par\u00e0metres.</li> </ul> <p>Altres exemples de requisits:</p> Requisit Significat <code>[a-zA-Z]+</code> Nom\u00e9s lletres <code>[0-9]{4}</code> Exactament 4 d\u00edgits <code>[A-Z]{3}\\d{2}</code> 3 maj\u00fascules i 2 n\u00fameros (p. ex. codis)"},{"location":"Tema2/#34-rutes-amb-parametres-per-defecte","title":"3.4. Rutes amb par\u00e0metres per defecte","text":"<p>Podem indicar valors per defecte per als par\u00e0metres d\u2019una ruta amb l\u2019opci\u00f3 <code>defaults:</code>. Aix\u00f2 permet que la ruta siga v\u00e0lida encara que no es passe cap valor.</p> <pre><code>&lt;?php\n\n#[Route('/blog/{pagina}', name: 'llista_blog', defaults: ['pagina' =&gt; 1])]\npublic function llista(int $pagina): Response\n{\n    return new Response(\"Est\u00e0s a la p\u00e0gina $pagina del blog\");\n}\n\n?&gt;\n</code></pre> <p>\ud83e\udde0 Explicaci\u00f3:</p> <ul> <li>Si accedim a <code>/blog/3</code>, mostrar\u00e0 \u201cEst\u00e0s a la p\u00e0gina 3 del blog\u201d.  </li> <li>Si accedim a <code>/blog/</code>, Symfony assignar\u00e0 autom\u00e0ticament <code>pagina = 1</code>.  </li> <li>Els valors per defecte eviten errors i fan les rutes m\u00e9s flexibles.</li> </ul> <p>Tamb\u00e9 es poden combinar defaults i requirements:</p> <pre><code>&lt;?php\n\n#[Route(\n    '/blog/{pagina}',\n    name: 'llista_blog',\n    defaults: ['pagina' =&gt; 1],\n    requirements: ['pagina' =&gt; '\\d+']\n)]\n\n?&gt;\n</code></pre> <p>\ud83e\udde9 Aix\u00ed assegurem que el par\u00e0metre <code>pagina</code> siga un n\u00famero i, si no es proporciona, prenga el valor <code>1</code> per defecte.</p>"},{"location":"Tema2/#4-exemple-del-controlador","title":"4. Exemple del controlador","text":"<p>A continuaci\u00f3 veurem un exemple complet d\u2019un controlador amb dues rutes amb el mateix patr\u00f3 (<code>/contacte/{valor}</code>), per\u00f2 diferenciades per tipus de par\u00e0metre:</p> <ul> <li>Si el par\u00e0metre \u00e9s num\u00e8ric, es mostrar\u00e0 la fitxa del contacte amb eixe codi.  </li> <li>Si el par\u00e0metre cont\u00e9 text, es far\u00e0 una cerca de contactes pel nom.</li> </ul> <p>Abans d\u2019utilitzar una base de dades, simularem les dades amb un array local i mostrarem el contacte amb el codi indicat.</p> <p>Fitxer: <code>src/Controller/ContacteController.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Attribute\\Route;\n\nclass ContacteController\n{\n    // Llista de contactes de mostra\n    private $contactes = [\n        [\"codi\" =&gt; 1, \"nom\" =&gt; \"Salvador Sala\", \n         \"telefon\" =&gt; \"638961244\", \"email\" =&gt; \"salvasala@simarro.org\"],\n        [\"codi\" =&gt; 2, \"nom\" =&gt; \"Anna Llopis\", \n         \"telefon\" =&gt; \"669332004\", \"email\" =&gt; \"annallopis@simarro.org\"],\n        [\"codi\" =&gt; 3, \"nom\" =&gt; \"Marc Sanchis\", \n         \"telefon\" =&gt; \"962286040\", \"email\" =&gt; \"marcsanchis@simarro.org\"],\n        [\"codi\" =&gt; 4, \"nom\" =&gt; \"Laura Palop\", \n         \"telefon\" =&gt; \"663568890\", \"email\" =&gt; \"laurapalop@simarro.org\"],\n    ];\n\n    // --- M\u00e8tode 1: Mostrar la fitxa d\u2019un contacte pel seu codi ---\n    // Ruta activa quan el par\u00e0metre \u00e9s num\u00e8ric (\\\\d+)\n    #[Route('/contacte/{codi}', name:'fitxa_contacte', requirements: ['codi' =&gt; '\\\\d+'])]\n    public function fitxa(int $codi): Response\n    {\n        $resultat = array_filter($this-&gt;contactes, \n            function($contacte) use ($codi){\n                return $contacte['codi'] == $codi;\n            }\n        );\n\n        if (!$resultat) \n            return new Response('Contacte no trobat');\n\n        // Torna 1r element\n        $contacte = array_shift($resultat);\n        $resp = \"&lt;ul&gt;\n                    &lt;li&gt;{$contacte['nom']}&lt;/li&gt;\n                    &lt;li&gt;{$contacte['telefon']}&lt;/li&gt;\n                    &lt;li&gt;{$contacte['email']}&lt;/li&gt;\n                &lt;/ul&gt;\";\n\n        return new Response(\"&lt;html&gt;&lt;body&gt;$resp&lt;/body&gt;&lt;/html&gt;\");\n    }\n\n\n    // --- M\u00e8tode 2: Buscar contactes pel nom ---\n    // Mateixa ruta /contacte/{text}, per\u00f2 amb requirement diferent (nom\u00e9s lletres)\n    #[Route('/contacte/{text}', name:'buscar_contacte', requirements: ['text' =&gt; '[a-zA-Z]+'])]\n    public function buscar(string $text): Response\n    {\n        $resultat = array_filter($this-&gt;contactes, \n            function($contacte) use ($text) {\n                return stripos($contacte[\"nom\"], $text) !== false;\n            }\n        );\n\n        if (!$resultat) \n            return new Response(\"No s'han trobat contactes amb '$text'.\");\n\n\n        $resposta = \"&lt;h2&gt;Resultats de la cerca: '$text'&lt;/h2&gt;\";\n        foreach ($resultat as $contacte) {\n            $resposta .= \"&lt;ul&gt;\n                            &lt;li&gt;{$contacte['nom']}&lt;/li&gt;\n                            &lt;li&gt;{$contacte['telefon']}&lt;/li&gt;\n                            &lt;li&gt;{$contacte['email']}&lt;/li&gt;\n                          &lt;/ul&gt;\";\n        }\n\n        return new Response(\"&lt;html&gt;&lt;body&gt;$resposta&lt;/body&gt;&lt;/html&gt;\");\n\n    }\n}\n?&gt;\n</code></pre> <p>\ud83e\udde0 Explicaci\u00f3 del funcionament</p> <ul> <li>Symfony analitza l\u2019URL <code>/contacte/{param}</code> i comprova quin requirement compleix:<ul> <li>Si \u00e9s num\u00e8ric (<code>\\\\d+</code>), crida al m\u00e8tode <code>fitxa()</code>.</li> <li>Si cont\u00e9 lletres (<code>[a-zA-Z]+</code>), crida al m\u00e8tode <code>buscar()</code>.</li> </ul> </li> <li>D\u2019aquesta manera no hi ha conflicte encara que la ruta siga la mateixa.</li> <li>L\u2019avantatge \u00e9s que l\u2019usuari pot accedir amb una sola estructura d\u2019URL:<ul> <li><code>/contacte/3</code> \u2192 mostra el contacte amb codi 3.  </li> <li><code>/contacte/anna</code> \u2192 busca \u201canna\u201d dins dels noms.</li> </ul> </li> </ul>"},{"location":"Tema2/#5-separacio-mvc-real","title":"5. Separaci\u00f3 MVC real","text":"<p>Els primers exemples encara barregen vista i controlador, ja que el text HTML est\u00e0 dins del m\u00e8tode.</p> <p>En un projecte real, el controlador nom\u00e9s ha de passar dades a una vista Twig per a renderitzar el resultat. Ho veurem a tema seg\u00fcent.</p> <p>Flux b\u00e0sic:</p> <pre><code>Usuari \u2192 Controlador \u2192 Model \u2192 Vista (HTML)\n</code></pre>"},{"location":"Tema2/#6-parts-obsoletes-o-a-evitar","title":"6. Parts obsoletes o a evitar","text":"Obsolet Substituci\u00f3 actual Versions Symfony &lt; 5.4 Treballar amb Symfony 6.x o superior PHP 7.x Utilitzar PHP 8.1 o superior <code>@Route(\"/ruta\")</code> <code>#[Route(\"/ruta\")]</code> Retornar HTML directament amb <code>new Response()</code> Fer servir <code>$this-&gt;render()</code> amb Twig"},{"location":"Tema2/#7-conclusio","title":"7. Conclusi\u00f3","text":"<p>El patr\u00f3 MVC \u00e9s la base del desenvolupament amb Symfony:</p> <ul> <li>Separa clarament la l\u00f2gica, les dades i la presentaci\u00f3.</li> <li>Millora l\u2019escalabilitat i la seguretat del projecte.</li> <li>\u00c9s compatible amb bones pr\u00e0ctiques com la injecci\u00f3 de depend\u00e8ncies i l\u2019\u00fas de serveis.</li> </ul> <p>Symfony implementa el patr\u00f3 MVC de manera nativa, i cada part del framework est\u00e0 pensada per a respectar aquesta arquitectura.</p>"},{"location":"Tema3/","title":"\ud83d\udcd8 TEMA 3 \u2014 Plantilles amb Twig","text":""},{"location":"Tema3/#1-definint-plantilles-de-vistes-amb-twig","title":"1. Definint plantilles de vistes amb Twig","text":"<p>Els controladors que hem vist fins ara generaven HTML directament al codi PHP. Per a separar el disseny de la l\u00f2gica, Symfony utilitza Twig, un motor de plantilles que permet treballar amb fitxers <code>.html.twig</code> dins la carpeta <code>templates/</code>.</p> <p>Twig ens ajuda a mantindre una estructura MVC clara, on el controlador prepara les dades i la vista s'encarrega de mostrar-les.</p>"},{"location":"Tema3/#11-la-nostra-primera-plantilla","title":"1.1. La nostra primera plantilla","text":"<p>Veurem com renderitzar una plantilla amb Twig. </p> <p>Controlador</p> <p>El controlador ha d\u2019heretar d'<code>AbstractController</code>, la qual ens ofereix el m\u00e8tode <code>render()</code> per mostrar vistes. </p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n\nclass IniciController extends AbstractController\n{\n    #[Route('/', name: 'inici')]\n    public function inici(): Response\n    {\n        return $this-&gt;render('inici.html.twig');\n    }\n}\n\n?&gt;\n</code></pre> <p>Vista (<code>templates/inici.html.twig</code>)</p> <p>Les plantilles (vistes) s\u2019emmagatzemen a la carpeta <code>templates/</code> i utilitzen l\u2019extensi\u00f3 <code>.html.twig</code>.</p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Contactes&lt;/h1&gt;\n    &lt;h2&gt;Benvingut al web de contactes.&lt;/h2&gt;\n    &lt;p&gt;P\u00e0gina d'inici&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\ud83d\udca1 Encara que aquesta vista \u00e9s totalment est\u00e0tica, ja es processa a trav\u00e9s de Twig i pot rebre dades del controlador.</p>"},{"location":"Tema3/#12-plantilles-amb-parts-variables","title":"1.2. Plantilles amb parts variables","text":"<p>Podem passar informaci\u00f3 del controlador a la plantilla mitjan\u00e7ant un array associatiu:</p> <p>Controlador</p> <pre><code>&lt;?php\n\n#[Route('/contacte/{codi}', name: 'fitxa_contacte')]\npublic function fitxa(int $codi): Response\n{\n    $contacte = [\n        'nom' =&gt; 'Anna Puig',\n        'telefon' =&gt; '612345678',\n        'email' =&gt; 'anna@simarro.org'\n    ];\n\n    return $this-&gt;render('fitxa_contacte.html.twig', [\n        'contacte' =&gt; $contacte\n    ]);\n}\n\n?&gt;\n</code></pre> <p>Vista (<code>fitxa_contacte.html.twig</code>)</p> <pre><code>&lt;h1&gt;Fitxa de contacte&lt;/h1&gt;\n&lt;ul&gt;\n  &lt;li&gt;&lt;strong&gt;{{ contacte.nom }}&lt;/strong&gt;&lt;/li&gt;\n  &lt;li&gt;Tel\u00e8fon: {{ contacte.telefon }}&lt;/li&gt;\n  &lt;li&gt;E-mail: {{ contacte.email }}&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre> <p>\ud83d\udca1 La notaci\u00f3 <code>{{ ... }}</code> continua sent la forma est\u00e0ndard de mostrar variables. Les dades s\u2019escapen autom\u00e0ticament per evitar atacs de seguretat.</p>"},{"location":"Tema3/#13-plantilles-base-i-herencia","title":"1.3. Plantilles base i her\u00e8ncia","text":"<p>Twig permet reutilitzar estructures HTML comunes (com cap\u00e7alera, men\u00fa o peu de p\u00e0gina) gr\u00e0cies als blocs i her\u00e8ncia.</p> <p>Plantilla base (<code>base.html.twig</code>)</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;{% block title %}Aplicaci\u00f3 Symfony{% endblock %}&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;header&gt;&lt;h1&gt;Contactes&lt;/h1&gt;&lt;/header&gt;\n\n    &lt;main&gt;\n      {% block contingut %}\n        &lt;!-- Contingut espec\u00edfic de cada p\u00e0gina --&gt;\n      {% endblock %}\n    &lt;/main&gt;\n\n    &lt;footer&gt;\n      &lt;p&gt;&amp;copy; {{ \"now\"|date(\"Y\") }} IES Llu\u00eds Simarro&lt;/p&gt;\n    &lt;/footer&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Plantilla filla (<code>inici.html.twig</code>)</p> <pre><code>{% extends 'base.html.twig' %}\n\n{% block title %}Inici{% endblock %}\n\n{% block contingut %}\n  &lt;h1&gt;Benvingut a la nostra aplicaci\u00f3&lt;/h1&gt;\n{% endblock %}\n</code></pre>"},{"location":"Tema3/#14-comentaris-estructures-de-control-i-filtres","title":"1.4. Comentaris, estructures de control i filtres","text":""},{"location":"Tema3/#141-comentaris","title":"1.4.1. Comentaris","text":"<pre><code>{# Aquest comentari no apareix al navegador #}\n</code></pre>"},{"location":"Tema3/#142-condicionals","title":"1.4.2. Condicionals","text":"<pre><code>{% if contacte.email %}\n  &lt;p&gt;Correu: {{ contacte.email }}&lt;/p&gt;\n{% else %}\n  &lt;p&gt;Sense correu electr\u00f2nic&lt;/p&gt;\n{% endif %}\n</code></pre>"},{"location":"Tema3/#143-bucles","title":"1.4.3. Bucles","text":"<pre><code>&lt;ul&gt;\n  {% for contacte in contactes %}\n    &lt;li&gt;{{ contacte.nom }} - {{ contacte.telefon }}&lt;/li&gt;\n  {% endfor %}\n&lt;/ul&gt;\n</code></pre>"},{"location":"Tema3/#144-cicles","title":"1.4.4. Cicles","text":"<p>La funci\u00f3 <code>cycle</code> de Twig \u00e9s molt \u00fatil quan volem alternar valors de manera c\u00edclica dins d\u2019un bucle. S\u2019utilitza habitualment per canviar colors, classes CSS o estils en llistats.</p> <p>Volem mostrar un llistat amb 10 files alternant dos estils de fila: <code>parell</code> i <code>imparell</code>.</p> <pre><code>{% for i in 1..10 %}\n  &lt;div class=\"{{ cycle(['parell', 'imparell'], i) }}\"&gt;\n    Fila n\u00famero {{ i }}\n  &lt;/div&gt;\n{% endfor %}\n</code></pre> <p>Com funciona <code>cycle</code>:</p> <ul> <li>El primer argument \u00e9s una llista de valors que es repetiran.</li> <li>El segon argument (<code>i</code> en aquest cas) indica la posici\u00f3 actual del cicle.</li> </ul> <p>Resultat generat (simplificat)</p> <pre><code>&lt;div class=\"parell\"&gt;Fila n\u00famero 1&lt;/div&gt;\n&lt;div class=\"imparell\"&gt;Fila n\u00famero 2&lt;/div&gt;\n&lt;div class=\"parell\"&gt;Fila n\u00famero 3&lt;/div&gt;\n...\n</code></pre>"},{"location":"Tema3/#145-filtres","title":"1.4.5. Filtres","text":"<pre><code>{{ contacte.nom | upper }}        {# maj\u00fascules #}\n{{ contacte.nom | lower }}        {# min\u00fascules #}\n{{ \"now\" | date(\"d/m/Y\") }}       {# data actual #}\n{{ contactes | length }}          {# quantitat d\u2019elements #}\n</code></pre> <p>\ud83d\udca1 En Symfony 6.4+ o superior, es recomana usar sempre filtres Twig en lloc de manipular cadenes amb PHP.</p>"},{"location":"Tema3/#15-inclusio-de-plantilles","title":"1.5. Inclusi\u00f3 de plantilles","text":"<p>En Twig podem inserir altres plantilles dins d\u2019una per reutilitzar codi i millorar l\u2019organitzaci\u00f3 de les nostres vistes.  </p> <p>Aquesta t\u00e8cnica s\u2019anomena inclusi\u00f3 de plantilles i \u00e9s especialment \u00fatil per a elements comuns com men\u00fas, peus de p\u00e0gina o barres laterals.</p> <p>Exemple pr\u00e0ctic</p> <p>Suposem que tenim l\u2019estructura seg\u00fcent dins del directori <code>templates/</code>:</p> <pre><code>templates/\n\u2502\n\u251c\u2500\u2500 base.html.twig\n\u251c\u2500\u2500 index.html.twig\n\u2514\u2500\u2500 partials/\n    \u251c\u2500\u2500 _menu.html.twig\n    \u2514\u2500\u2500 _footer.html.twig\n</code></pre> <ul> <li>Desa les plantilles parcials dins d\u2019una carpeta <code>partials/</code>.</li> <li>Utilitza un gui\u00f3 baix (<code>_</code>) al principi del nom per indicar que s\u00f3n plantilles auxiliars: <code>_menu.html.twig</code>, <code>_footer.html.twig</code>.</li> </ul> <p>Fitxer (<code>partials/_menu.html.twig</code>)</p> <p>Aquest fitxer cont\u00e9 el men\u00fa principal del nostre lloc web.</p> <pre><code>&lt;nav&gt;\n  &lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Inici&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Articles&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Contacte&lt;/a&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/nav&gt;\n</code></pre> <p>Laboratori</p> <p>Crea un peu de p\u00e0gina per a l\u2019aplicaci\u00f3 en el fitxer <code>partials/_footer.html.twig</code>.</p> <p>Fitxer (<code>base.html.twig</code>)</p> <p>Ac\u00ed definim l\u2019estructura principal de la p\u00e0gina i incloem el men\u00fa i el peu de p\u00e0gina amb la directiva <code>include</code>.</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"ca\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;{% block title %}Aplicaci\u00f3 Symfony{% endblock %}&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n\n    {# Incloem el men\u00fa com una plantilla parcial #}\n    {% include 'partials/_menu.html.twig' %}\n\n    &lt;main&gt;\n        {% block contingut %}\n          &lt;!-- Contingut espec\u00edfic de cada p\u00e0gina --&gt;\n        {% endblock %}\n    &lt;/main&gt;\n\n    {# Incloem el peu de p\u00e0gina #}\n    {% include 'partials/_footer.html.twig' %}\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Fitxer (<code>inici.html.twig</code>)</p> <p>Aquesta plantilla hereta de <code>base.html.twig</code> i defineix el bloc de contingut:</p> <pre><code>{% extends 'base.html.twig' %}\n\n{% block title %}P\u00e0gina principal{% endblock %}\n\n{% block contingut %}\n  &lt;h1&gt;Benvinguts a la p\u00e0gina principal&lt;/h1&gt;\n  &lt;p&gt;Aquesta p\u00e0gina utilitza el men\u00fa i el peu de p\u00e0gina amb include.&lt;/p&gt;\n{% endblock %}\n</code></pre> <p>Resultat en navegador</p> <p>Quan renderitzes <code>inici.html.twig</code>, Twig combinar\u00e0 totes les plantilles:</p> <pre><code>&lt;nav&gt;\n  &lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Inici&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Articles&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"\"&gt;Contacte&lt;/a&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/nav&gt;\n\n&lt;main&gt;\n  &lt;h1&gt;Benvinguts a la p\u00e0gina principal&lt;/h1&gt;\n  &lt;p&gt;Aquesta p\u00e0gina utilitza el men\u00fa i el peu de p\u00e0gina amb include.&lt;/p&gt;\n&lt;/main&gt;\n\n&lt;footer&gt;\n  \u00a9 2025 IES Llu\u00eds Simarro\n&lt;/footer&gt;\n</code></pre>"},{"location":"Tema3/#16-enllacar-a-altres-rutes-de-laplicacio","title":"1.6. Enlla\u00e7ar a altres rutes de l\u2019aplicaci\u00f3","text":"<p>Si el que volem \u00e9s definir un enlla\u00e7 a una altra ruta o p\u00e0gina de la nostra aplicaci\u00f3, utilitzem la funci\u00f3 <code>path()</code> per indicar el nom (<code>name</code>) assignat a la ruta a la qual volem anar.</p> <p>Per exemple, si volem anar a la fitxa d\u2019un contacte el codi del qual est\u00e0 emmagatzemat en la variable <code>codi</code>, escriurem:</p> <pre><code>&lt;a href=\"{{ path('fitxa_contacte', {'codi': codi}) }}\"&gt;Veure fitxa&lt;/a&gt;\n</code></pre> <p>Aquesta instrucci\u00f3 genera autom\u00e0ticament l\u2019enlla\u00e7 segons les rutes definides al controlador.</p> <p>Si la ruta est\u00e0 declarada aix\u00ed:</p> <pre><code>#[Route('/contacte/{codi}', name: 'fitxa_contacte')]\n</code></pre> <p>i la variable <code>codi</code> val <code>12</code>, el resultat final ser\u00e0:</p> <pre><code>&lt;a href=\"/contacte/12\"&gt;Veure fitxa&lt;/a&gt;\n</code></pre> <p>Quan la ruta no t\u00e9 par\u00e0metres, simplement podem fer:</p> <pre><code>&lt;a href=\"{{ path('inici') }}\"&gt;Tornar a l\u2019inici&lt;/a&gt;\n</code></pre> <p>Si necessitem generar una URL absoluta (per a correus o enlla\u00e7os externs), emprarem <code>url()</code>:</p> <pre><code>&lt;a href=\"{{ url('fitxa_contacte', {'codi': codi}) }}\"&gt;Fitxa completa&lt;/a&gt;\n</code></pre> Funci\u00f3 Twig Resultat Exemple \u00das recomanat <code>path('nom_ruta')</code> URL relativa <code>/contacte/12</code> Enlla\u00e7os dins la web <code>url('nom_ruta')</code> URL absoluta <code>https://exemple.com/contacte/12</code> Enlla\u00e7os externs o correus <p>Laboratori</p> <p>Edita la plantilla del men\u00fa de navegaci\u00f3 i actualitza els seg\u00fcents enlla\u00e7os:</p> <ul> <li>L'enlla\u00e7 Inici que vaja a la p\u00e0gina principal (ruta arrel del projecte).</li> <li>L'enlla\u00e7 Contacte que vaja a la ruta del contacte de codi 2 utilitzant la funci\u00f3 <code>path()</code>.</li> </ul>"},{"location":"Tema3/#17-afegir-contingut-estatic-a-les-plantilles","title":"1.7. Afegir contingut est\u00e0tic a les plantilles","text":"<p>En una aplicaci\u00f3 Symfony moderna, els recursos est\u00e0tics (fulls d\u2019estil, imatges i JavaScript) es desen dins la carpeta <code>assets/</code> i es publiquen autom\u00e0ticament a <code>public/</code> mitjan\u00e7ant AssetMapper.</p> <p>Estructura recomanada de carpetes</p> <pre><code>assets/\n\u2514\u2500\u2500 imgs/\n    \u251c\u2500\u2500 sony-wh1000.jpg\n    \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 styles/\n    \u2514\u2500\u2500 app.css\n\u2514\u2500\u2500 app.js\n</code></pre> <p>Instal\u00b7laci\u00f3 i comandes \u00fatils</p> <pre><code># Instal.la el component (si no el t\u00e9)\ncomposer require symfony/asset-mapper\n\n# Mostra la llista d\u2019actius disponibles\nphp bin/console debug:asset-map\n\n# Genera c\u00f2pies versionades per a producci\u00f3\nphp bin/console asset-map:compile\n</code></pre> <p>A continuaci\u00f3 veurem com incloure aquests recursos est\u00e0tics a les nostres plantilles.</p>"},{"location":"Tema3/#171-fulls-destil-css","title":"1.7.1. Fulls d\u2019estil (CSS)","text":"<p>Crea dins de la carpeta <code>assets/</code> una subcarpeta <code>styles/</code> i afegeix-hi un fitxer anomenat <code>estils.css</code>:</p> <p>Ruta del fitxer: </p> <pre><code>assets/styles/estils.css\n</code></pre> <p>Contingut de prova:</p> <pre><code>/* Estils generals */\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: Arial, Helvetica, sans-serif;\n  background-color: #f5f5f5;\n  color: #333;\n}\n\n/* Contenidor principal */\nmain {\n  width: 80%;\n  margin: 2rem auto;\n  background: white;\n  padding: 2rem;\n  border-radius: 8px;\n  box-shadow: 0 0 12px rgba(0,0,0,0.1);\n}\n\n/* Men\u00fa */\nnav {\n  background-color: #004b8d;\n  padding: 0.75rem 0;\n}\n\nnav ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  text-align: center;\n}\n\nnav ul li {\n  display: inline-block;\n  margin: 0 1.5rem;\n}\n\nnav ul li a {\n  color: white;\n  text-decoration: none;\n  font-weight: bold;\n  transition: 0.3s;\n}\n\nnav ul li a:hover {\n  text-decoration: underline;\n}\n\n/* T\u00edtols */\nh1, h2, h3 {\n  color: #004b8d;\n}\n\n/* Peu de p\u00e0gina */\nfooter {\n  text-align: center;\n  padding: 1rem 0;\n  background-color: #222;\n  color: white;\n  margin-top: 2rem;\n}\n</code></pre> <p>Per carregar aquest full d\u2019estil en totes les p\u00e0gines, edita la plantilla base <code>base.html.twig</code> i afegeix la l\u00ednia seg\u00fcent dins del bloc <code>stylesheets</code>:</p> <pre><code>{% block stylesheets %}\n  &lt;link href=\"{{ asset('styles/estils.css') }}\" rel=\"stylesheet\" /&gt;\n{% endblock %}\n</code></pre> <p>\ud83d\udca1 La funci\u00f3 <code>asset()</code> genera autom\u00e0ticament la ruta correcta del fitxer segons la configuraci\u00f3 del projecte.</p> <p>Recomanat: compilaci\u00f3 autom\u00e0tica</p> <p>Perqu\u00e8 cada canvi es recompile autom\u00e0ticament sense haver d'executar cap ordre, utilitza: <pre><code>php bin/console asset-map:watch\n</code></pre></p> <p>Compilaci\u00f3 manualment</p> <p>La compilaci\u00f3 dels canvis en els arxius d'estils hauria de fer-se autom\u00e0ticament mitjan\u00e7ant el mode watch. Nom\u00e9s utilitzarem la compilaci\u00f3 manual si el mode autom\u00e0tic no est\u00e0 actiu o no funciona correctament. <pre><code>php bin/console asset-map:compile\n</code></pre></p>"},{"location":"Tema3/#172-imatges","title":"1.7.2. Imatges","text":"<p>Per mostrar imatges desades a la carpeta <code>assets/imgs/</code>, pots fer-ho aix\u00ed:</p> <pre><code>&lt;img src=\"{{ asset('imgs/imatge.png') }}\" alt=\"Exemple d\u2019imatge\"&gt;\n</code></pre> <p>Si necessites una URL absoluta (per exemple, per enviar-la en un correu electr\u00f2nic o per compartir-la fora de la web), pots combinar <code>absolute_url()</code> amb <code>asset()</code>:</p> <pre><code>&lt;img src=\"{{ absolute_url(asset('imgs/imatge.png')) }}\" alt=\"Ex. d\u2019imatge\"&gt;\n</code></pre>"},{"location":"Tema3/#173-fitxers-javascript","title":"1.7.3. Fitxers JavaScript","text":"<p>Els fitxers <code>.js</code> s\u2019acostumen a incloure al final del <code>body</code> o dins del bloc <code>javascripts</code> de la plantilla base.</p> <p>Per exemple, si tenim un fitxer <code>assets/js/llibreria.js</code>, el carregar\u00edem aix\u00ed:</p> <pre><code>{% block javascripts %}\n  &lt;script src=\"{{ asset('js/llibreria.js') }}\" defer&gt;&lt;/script&gt;\n{% endblock %}\n</code></pre> <p>\ud83d\udca1 L'opci\u00f3 <code>defer</code> fa que el JS s'execute despr\u00e9s de carregar l'HTML, millorant el rendiment.</p>"},{"location":"Tema3/#174-bones-practiques","title":"1.7.4. Bones pr\u00e0ctiques","text":"<ul> <li>Guarda tots els recursos est\u00e0tics dins <code>assets/</code> i organitza\u2019ls per carpetes (<code>styles/</code>, <code>js/</code>, <code>imgs/</code>...).</li> <li>La carpeta <code>public/</code> queda per a arxius realment p\u00fablics que no passen per AssetMapper (per exemple <code>robots.txt</code>, <code>favicon.ico</code> o fitxers pujats per l\u2019usuari).  </li> <li>Fes servir sempre <code>asset()</code> o <code>absolute_url()</code> en lloc de rutes relatives manuals.</li> <li>Si vols enlla\u00e7ar una URL externa (p. ex. <code>https://cdn.jsdelivr.net/...</code>), posa-la directament al <code>src</code> o <code>href</code>, sense <code>asset()</code>.</li> </ul>"},{"location":"Tema3/#18-resum","title":"1.8. Resum","text":"Eina Twig Serveix per a... Exemple pr\u00e0ctic S\u00edmil programaci\u00f3 <code>{% extends %}</code> Heretar una plantilla completa <code>inici.html.twig</code> hereta de <code>base.html.twig</code> Classe filla \u2194 classe pare <code>{% include %}</code> Afegir una pe\u00e7a o component com\u00fa Inserir un men\u00fa o un peu de p\u00e0gina Copiar/enganxar un m\u00f2dul <code>{% block %}</code> Definir zones modificables dins la base <code>body</code>, <code>title</code>, etc. M\u00e8tode que pots sobreescriure <p>Funcionament:</p> <ul> <li><code>extends</code> defineix qui hereta.</li> <li><code>include</code> afegeix peces reutilitzables dins de l\u2019estructura.</li> <li><code>block</code> marca qu\u00e8 pot canviar.</li> </ul>"},{"location":"Tema3/#19-bones-practiques-amb-twig","title":"1.9. Bones pr\u00e0ctiques amb Twig","text":"<ul> <li>Mantindre les vistes lliures de l\u00f2gica de negoci.  </li> <li>Utilitzar blocs, includes i her\u00e8ncia per evitar repeticions.  </li> <li>Passar nom\u00e9s les dades necess\u00e0ries des del controlador.  </li> <li>Organitzar les plantilles en carpetes (<code>templates/contacte/</code>, <code>templates/partials/</code>...).  </li> <li>Usar noms coherents i sem\u00e0ntics per a les variables.</li> </ul>"},{"location":"Tema3/#2-actualitzacions-i-parts-obsoletes","title":"2. Actualitzacions i parts obsoletes","text":"Tema original Estat actual Recomanaci\u00f3 <code>renderView()</code> i <code>Response</code> manual Encara v\u00e0lid per\u00f2 poc usat Fes servir <code>$this-&gt;render()</code> Injecci\u00f3 de depend\u00e8ncies en vistes (acc\u00e9s directe a <code>app.*</code>) Desaconsellat Passa les dades expl\u00edcitament Variables globals de Twig (<code>app.request</code>, <code>app.user</code>) Mantingudes Nom\u00e9s per a casos espec\u00edfics <code>{{ asset() }}</code> per recursos Vigent per\u00f2 millorable Usa AssetMapper si el projecte est\u00e0 en Symfony 6.4+"},{"location":"Tema3/#3-exemple-complet","title":"3. Exemple complet","text":""},{"location":"Tema3/#31-estructura-de-fitxers","title":"3.1. Estructura de fitxers","text":"<pre><code>src/\n\u2514\u2500\u2500 Controller/\n    \u2514\u2500\u2500 ContacteController.php\n\ntemplates/\n\u251c\u2500\u2500 base.html.twig\n\u2514\u2500\u2500 contacte/\n    \u251c\u2500\u2500 fitxa.html.twig\n    \u2514\u2500\u2500 cerca.html.twig\n</code></pre>"},{"location":"Tema3/#32-controlador","title":"3.2. Controlador","text":"<p>Fitxer: <code>src/Controller/ContacteController.php</code></p> <pre><code>&lt;?php\nnamespace App\\Controller;\n\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Attribute\\Route;\n\nclass ContacteController extends AbstractController\n{\n    private array $contactes = [\n        [\"codi\" =&gt; 1, \"nom\" =&gt; \"Salvador Sala\",\n         \"telefon\" =&gt; \"638961244\", \"email\" =&gt; \"salvasala@simarro.org\"],\n        [\"codi\" =&gt; 2, \"nom\" =&gt; \"Anna Llopis\",\n         \"telefon\" =&gt; \"669332004\", \"email\" =&gt; \"annallopis@simarro.org\"],\n        [\"codi\" =&gt; 3, \"nom\" =&gt; \"Marc Sanchis\",\n         \"telefon\" =&gt; \"962286040\", \"email\" =&gt; \"marcsanchis@simarro.org\"],\n        [\"codi\" =&gt; 4, \"nom\" =&gt; \"Laura Palop\",\n         \"telefon\" =&gt; \"663568890\", \"email\" =&gt; \"laurapalop@simarro.org\"],\n    ];\n\n    // M\u00e9tode 1\n    #[Route('/contacte/{codi}', name: 'fitxa_contacte', requirements: ['codi' =&gt; '\\\\d+'])]\n    public function fitxa(int $codi): Response\n    {\n        // 1) Buscar el contacte pel codi\n        $resultat = array_filter($this-&gt;contactes, fn($c) =&gt; $c['codi'] === $codi);\n\n        if (!$resultat) {\n            // En un cas real, podr\u00edem llan\u00e7ar una 404 o mostrar una vista d\u2019error\n            return $this-&gt;render('contacte/fitxa.html.twig', [\n                'contacte' =&gt; null,\n                'codi' =&gt; $codi,\n            ]);\n        }\n\n        $contacte = array_shift($resultat);\n\n        // 2) Passar dades a la plantilla Twig\n        return $this-&gt;render('contacte/fitxa.html.twig', [\n            'contacte' =&gt; $contacte,\n            'codi' =&gt; $codi,\n        ]);\n    }\n\n    // M\u00e9tode 2\n    #[Route('/contacte/{text}', name: 'buscar_contacte', requirements: ['text' =&gt; '[a-zA-Z]+'])]\n    public function buscar(string $text): Response\n    {\n        // 1) Filtrar per nom (coincid\u00e8ncia parcial, sense tindre en compte maj./min.)\n        $resultat = array_filter($this-&gt;contactes, function ($c) use ($text) {\n            return stripos($c['nom'], $text) !== false;\n        });\n\n        // 2) Passar la llista (pot ser buida) a la vista\n        return $this-&gt;render('contacte/cerca.html.twig', [\n            'text' =&gt; $text,\n            'resultats' =&gt; $resultat,\n        ]);\n    }\n}\n</code></pre> <p>Qu\u00e8 hem canviat respecte a Tema 2? Ara no constru\u00efm HTML al controlador: sols preparem dades i les enviem a Twig per a pintar la resposta (exactament el que recoman\u00e0vem a la secci\u00f3 \u201cSeparaci\u00f3 MVC real\u201d del tema 2).</p>"},{"location":"Tema3/#33-plantilla-base","title":"3.3. Plantilla base","text":"<p>Fitxer: <code>templates/base.html.twig</code></p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"ca\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;{% block title %}Aplicaci\u00f3 Symfony{% endblock %}&lt;/title&gt;\n    {% block stylesheets %}\n      &lt;link href=\"{{ asset('styles/estils.css') }}\" rel=\"stylesheet\" /&gt;\n    {% endblock %}  \n  &lt;/head&gt;\n  &lt;body&gt;\n\n    {# Incloem el men\u00fa com una plantilla parcial #}\n    {% include 'partials/_menu.html.twig' %}\n\n    &lt;main&gt;\n        {% block contingut %}\n          &lt;!-- Contingut espec\u00edfic de cada p\u00e0gina --&gt;\n        {% endblock %}\n    &lt;/main&gt;\n\n    {# Incloem el peu de p\u00e0gina #}\n    {% include 'partials/_footer.html.twig' %}\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Tema3/#34-vista-de-fitxa","title":"3.4. Vista de fitxa","text":"<p>Fitxer: <code>templates/contacte/fitxa.html.twig</code></p> <pre><code>{% extends 'base.html.twig' %}\n\n{% block title %}Fitxa de contacte{% endblock %}\n\n{% block contingut %}\n  &lt;h2&gt;Fitxa de contacte&lt;/h2&gt;\n\n  {% if contacte %}\n    &lt;ul class=\"llista\"&gt;\n      &lt;li&gt;&lt;strong&gt;Nom:&lt;/strong&gt; {{ contacte.nom }}&lt;/li&gt;\n      &lt;li&gt;&lt;strong&gt;Tel\u00e8fon:&lt;/strong&gt; {{ contacte.telefon }}&lt;/li&gt;\n      &lt;li&gt;&lt;strong&gt;Email:&lt;/strong&gt; {{ contacte.email }}&lt;/li&gt;\n      &lt;li&gt;&lt;strong&gt;Codi intern:&lt;/strong&gt; {{ codi }}&lt;/li&gt;\n    &lt;/ul&gt;\n  {% else %}\n    &lt;p&gt;Contacte amb codi {{ codi }} no trobat.&lt;/p&gt;\n  {% endif %}\n{% endblock %}\n</code></pre>"},{"location":"Tema3/#35-vista-de-cerca","title":"3.5. Vista de cerca","text":"<p>Fitxer: <code>templates/contacte/cerca.html.twig</code></p> <pre><code>{% extends 'base.html.twig' %}\n\n{% block title %}Resultats per \"{{ text }}\"{% endblock %}\n\n{% block contingut %}\n  &lt;h2&gt;Resultats de la cerca: \u201c{{ text }}\u201d&lt;/h2&gt;\n\n  {% if resultats is not empty %}\n    {% for c in resultats %}\n      &lt;ul class=\"llista\"&gt;\n        &lt;li&gt;&lt;strong&gt;Nom:&lt;/strong&gt; {{ c.nom }}&lt;/li&gt;\n        &lt;li&gt;&lt;strong&gt;Tel\u00e8fon:&lt;/strong&gt; {{ c.telefon }}&lt;/li&gt;\n        &lt;li&gt;&lt;strong&gt;Email:&lt;/strong&gt; {{ c.email }}&lt;/li&gt;\n      &lt;/ul&gt;\n      &lt;hr&gt;\n    {% endfor %}\n  {% else %}\n    &lt;p&gt;No s\u2019han trobat contactes amb \u201c{{ text }}\u201d.&lt;/p&gt;\n  {% endif %}\n{% endblock %}\n</code></pre>"},{"location":"Tema3/#36-proves-rapides","title":"3.6. Proves r\u00e0pides","text":"<p>Fitxa (num\u00e8ric): \ud83d\udc49 <code>http://localhost/contacte/3</code> \u2192 mostra la fitxa amb codi 3.</p> <p>Cerca (text): \ud83d\udc49 <code>http://localhost/contacte/sa</code> \u2192 llista coincid\u00e8ncies per \"sa\".</p> <p>Ambd\u00f3s camins comparteixen prefix i es diferencien pel requirement de la ruta (igual que l\u2019exemple original del Tema 2).</p>"},{"location":"Tema3/#37-notes-i-bones-practiques","title":"3.7. Notes i bones pr\u00e0ctiques","text":"<ul> <li>Mant\u00edn l\u2019HTML fora del controlador; la vista \u00e9s responsabilitat de Twig.  </li> <li>Centralitza estils i estructura en <code>base.html.twig</code> i fes servir her\u00e8ncia (<code>{% extends %}</code>) i blocs (<code>{% block %}</code>).  </li> <li>Si reuses fragments (per ex. el llistat d\u2019un contacte), pots crear un partial: <code>templates/contacte/_targeta.html.twig</code> i incloure\u2019l amb <code>{% include %}</code>.</li> </ul>"},{"location":"Tema3/#4-recursos-recomanats","title":"4. Recursos recomanats","text":"<ul> <li>Documentaci\u00f3 oficial Twig 3.x </li> <li>Plantilles en Symfony 6.4+ </li> <li>Symfony AssetMapper (nou sistema d\u2019actius)</li> </ul>"},{"location":"Tema4/","title":"\ud83d\udcd8 Tema 4 \u2014 El contenidor de serveis i la injecci\u00f3 de depend\u00e8ncies","text":""},{"location":"Tema4/#1-introduccio","title":"1. Introducci\u00f3","text":"<p>En una aplicaci\u00f3 moderna, les classes solen necessitar objectes d\u2019altres classes per funcionar. Per exemple, un controlador pot necessitar un servei de registre de logs o acc\u00e9s a la base de dades.</p> <p>Sense un sistema d\u2019injecci\u00f3 de depend\u00e8ncies, el codi seria r\u00edgid i dif\u00edcil de mantenir, provocant:</p> <pre><code>&lt;?php\n\n// \u274c Exemple antic\n$logger = new Logger();\n$logger-&gt;info('S\u2019ha iniciat la p\u00e0gina');\n\n?&gt;\n</code></pre> <p>Amb injecci\u00f3 de depend\u00e8ncies, \u00e9s el framework (Symfony) qui crea i proporciona aquests objectes, anomenats serveis:</p> <pre><code>&lt;?php\n\n// \u2705 Exemple modern\npublic function __construct(private LoggerInterface $logger) {\n}\n\npublic function index(): Response\n{\n    $this-&gt;logger-&gt;info('S\u2019ha iniciat la p\u00e0gina');\n    return new Response('Hola m\u00f3n');\n}\n\n?&gt;\n</code></pre> <p>Aix\u00f2 permet:</p> <ul> <li>Millorar l'estructura del codi:<ul> <li>Elimina la duplicitat de codi.</li> <li>Redueix la dificultat de manteniment.</li> <li>Desacobla les classes i les fa m\u00e9s independents.</li> </ul> </li> <li>Augmnetar la flexibilitat:<ul> <li>Permet substituir f\u00e0cilment implementacions (p. ex. canviar el servei de logs).</li> <li>Facilita la reutilitzaci\u00f3 de components en diferents parts de l'aplicaci\u00f3.</li> </ul> </li> <li>Afavorir el desenvolupament i les proves:<ul> <li>Simplifica les proves unit\u00e0ries i la detecci\u00f3 d'errors.</li> </ul> </li> </ul>"},{"location":"Tema4/#2-el-contenidor-de-serveis","title":"2. El contenidor de serveis","text":"<p>Symfony disposa d\u2019un contenidor de serveis (Service Container):  un component central que s\u2019encarrega de crear, configurar i oferir tots els objectes (serveis) de l\u2019aplicaci\u00f3.</p>"},{"location":"Tema4/#21-que-es-un-servei","title":"2.1. Qu\u00e8 \u00e9s un servei?","text":"<p>Un servei \u00e9s qualsevol classe que realitza una tasca concreta dins de l\u2019aplicaci\u00f3:</p> <ul> <li>Enviar correus (<code>MailerInterface</code>)</li> <li>Registrar esdeveniments (<code>LoggerInterface</code>)</li> <li>Accedir a la base de dades (<code>EntityManagerInterface</code>)</li> <li>Validar dades (<code>ValidatorInterface</code>)</li> </ul> <p>El contenidor s\u2019encarrega de gestionar-los, creant-los nom\u00e9s quan cal.</p>"},{"location":"Tema4/#22-necessitat-dun-sistema-dinjeccio-de-dependencies","title":"2.2. Necessitat d\u2019un sistema d\u2019injecci\u00f3 de depend\u00e8ncies","text":"<p>En una aplicaci\u00f3, diferents classes poden necessitar accedir a la mateixa base de dades. Sense la injecci\u00f3 de depend\u00e8ncies, cada classe hauria de crear la seua pr\u00f2pia connexi\u00f3, duplicant codi i recursos.</p> <p>Amb la injecci\u00f3 de depend\u00e8ncies, \u00e9s el framework qui crea la connexi\u00f3 una sola vegada i la proporciona a totes les classes que la necessiten.</p> <p>Symfony gestiona aquest proc\u00e9s mitjan\u00e7ant el contenidor de serveis, un component que crea i administra tots els objectes compartits de l\u2019aplicaci\u00f3, anomenats serveis.</p>"},{"location":"Tema4/#3-configuracio-basica","title":"3. Configuraci\u00f3 b\u00e0sica","text":"<p>Quan creem un projecte amb Symfony, ja trobem un fitxer de configuraci\u00f3 anomenat <code>config/services.yaml</code>:</p> <pre><code>parameters:\n  locale: 'ca'          # Indica la localitazci\u00f3 i idioma per defecte\n\nservices:\n  _defaults:\n    autowire: true      # Symfony injecta autom\u00e0ticament el servei\n    autoconfigure: true # Crea o registra el servei segons el seu tipus\n    public: false       # Visibilitat: els serveis son privats per a Symfony\n\n  App\\:\n    resource: '../src/'\n    exclude:\n      - '../src/DependencyInjection/'\n      - '../src/Entity/'\n      - '../src/Kernel.php'\n\n  App\\Controller\\:\n    resource: '../src/Controller'           # Ruta controladors HTTP\n    tags: ['controller.service_arguments']  # Permet injecci\u00f3 dins dels m\u00e8todes\n</code></pre> <p>Symfony escaneja autom\u00e0ticament la carpeta <code>src/</code> i registra com a serveis totes les classes que troba, amb aquestes regles:</p> <ul> <li>Si estan dins d\u2019un namespace conegut (<code>App\\...</code>).</li> <li>I no s\u00f3n entitats (<code>Entity</code>) ni DTOs, ni configuracions internes (<code>DependencyInjection</code>), ni la classe principal (<code>Kernel.php</code>).</li> <li>Aleshores es registren com a serveis autom\u00e0ticament (gr\u00e0cies a l\u2019<code>autowire</code> i l\u2019<code>autoconfigure</code> activats al services.yaml).</li> </ul> <p>Aix\u00f2 vol dir:</p> <ul> <li>Tot el que hi ha a <code>src/Service</code>, <code>src/Repository</code>, <code>src/Security</code>... ser\u00e0 un servei disponible.</li> <li>Symfony sabr\u00e0 com crear-lo autom\u00e0ticament. Si alguna classe necessita un servei, l'injectarem al constructor.</li> </ul>"},{"location":"Tema4/#31-serveis-publics-i-privats","title":"3.1. Serveis p\u00fablics i privats","text":"<p>Per defecte, els serveis s\u00f3n privats (nom\u00e9s accessibles via injecci\u00f3). Si cal exposar-ne algun directament, podem marcar-lo com p\u00fablic:</p> <pre><code>App\\Service\\MissatgeService:\n  public: true\n</code></pre> <p>Nom\u00e9s s\u2019hauria de fer si \u00e9s estrictament necessari (per exemple, per usar-lo en comandes o scripts externs).</p>"},{"location":"Tema4/#4-crear-i-utilitzar-un-servei-propi","title":"4. Crear i utilitzar un servei propi","text":""},{"location":"Tema4/#41-definicio-dun-servei","title":"4.1 Definici\u00f3 d\u2019un servei","text":"<p>Creem una classe que encapsule una funcionalitat, per exemple un servei de missatges:</p> <p>Fitxer: <code>src/Service/MissatgeService.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Service;\n\nclass MissatgeService\n{\n    public function obtindreSalutacio(string $nom): string\n    {\n        return \"Hola, $nom! Benvingut a Symfony \ud83d\ude80\";\n    }\n}\n\n?&gt;\n</code></pre> <p>Gr\u00e0cies a l\u2019<code>autowire</code>, no cal registrar-la. Symfony la detectar\u00e0 autom\u00e0ticament.</p>"},{"location":"Tema4/#42-us-del-servei-en-un-controlador","title":"4.2 \u00das del servei en un controlador","text":"<p>Fitxer: <code>src/Controller/SalutacioController.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse App\\Service\\MissatgeService;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n\nclass SalutacioController extends AbstractController\n{\n    public function __construct(private MissatgeService $missatgeService) {\n\n    }\n\n    #[Route('/salutacio', name: 'salutacio')]\n    public function index(): Response\n    {\n        $text = $this-&gt;missatgeService-&gt;obtindreSalutacio('Anna');\n        return new Response($text);\n    }\n}\n\n?&gt;\n</code></pre> <p>\ud83d\udc49 En el constructor, el que fa PHP amb Property Promotion:</p> <ol> <li>Declara l\u2019atribut private MissatgeService $missatgeService.</li> <li>Declara el par\u00e0metre del constructor.</li> <li>Assigna autom\u00e0ticament $this-&gt;missatgeService = $missatgeService.</li> </ol> <p>\ud83d\udc49 En el constructor, el que fa Symfony amb la Injecci\u00f3 de depend\u00e8ncies:</p> <ol> <li>Detecta que el controlador necessita MissatgeService.</li> <li>Busca el servei en el contenidor.</li> <li>El crea autom\u00e0ticament (autowiring).</li> <li>L\u2019injecta com a par\u00e0metre en el constructor.</li> </ol> <p>\ud83d\udca1 A\u00e7\u00f2 s\u2019anomena Injecci\u00f3 de Depend\u00e8ncies (DI) i \u00e9s una bona pr\u00e0ctica perqu\u00e8 el controlador no s\u2019encarrega de crear el servei, sin\u00f3 que el rep preparat per a utilitzar-lo.</p>"},{"location":"Tema4/#43-exemple-classic","title":"4.3. Exemple cl\u00e0ssic","text":"<p>En este punt veurem com quedaria el controlador si no f\u00e9rem \u00fas de la caracter\u00edstica Property Promotion introdu\u00efda en PHP 8.</p> <p>Aquesta \u00e9s la forma \"cl\u00e0ssica\" de declarar depend\u00e8ncies en un controlador de Symfony.</p> <p>Fitxer: <code>src/Controller/SalutacioController.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse App\\Service\\MissatgeService;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n\nclass SalutacioController extends AbstractController\n{\n\n    // Declaraci\u00f3 manual de l'atribut\n    private MissatgeService $missatgeService;\n\n    public function __construct(MissatgeService $missatgeService) {\n        // Assignaci\u00f3 manual de la depend\u00e8ncia\n        $this-&gt;missatgeService = $missatgeService;\n    }\n\n    #[Route('/salutacio', name: 'salutacio')]\n    public function index(): Response\n    {\n        $text = $this-&gt;missatgeService-&gt;obtindreSalutacio('Anna');\n        return new Response($text);\n    }\n}\n\n?&gt;\n</code></pre> <p>Treballar sense Property Promotion implica diversos desavantatges:</p> <ul> <li>M\u00e9s codi repetitiu: has d\u2019escriure l\u2019atribut i tamb\u00e9 l\u2019assignaci\u00f3 en el constructor.</li> <li>Menys net i menys llegible.</li> <li>Afegeix treball innecessari: cada depend\u00e8ncia obliga a un atribut + una assignaci\u00f3.</li> <li>Propens a errors: \u00e9s f\u00e0cil oblidar-se d\u2019escriure $this-&gt;... = ..., ocasionant errors com \u201cundefined property\u201d o \u201cundefined variable\u201d.</li> <li>Manteniment m\u00e9s complicat: si afegeixes o elimines depend\u00e8ncies, cal tocar m\u00e9s codi.</li> </ul>"},{"location":"Tema4/#5-depuracio-de-serveis","title":"5. Depuraci\u00f3 de serveis","text":"<p>Symfony ofereix comandes per inspeccionar el contenidor:</p> <ul> <li>Per mostrar tots els serveis disponibles.</li> </ul> <pre><code>php bin/console debug:container\n\nphp bin/console debug:container App\\\n\nphp bin/console debug:container App\\Service\n</code></pre> <ul> <li>Per buscar un servei concret:</li> </ul> <pre><code>php bin/console debug:container MissatgeService\n</code></pre> <ul> <li>Per veure quines classes s\u00f3n autowirables:</li> </ul> <pre><code>php bin/console debug:autowiring\n</code></pre>"},{"location":"Tema4/#6-exemple-de-servei-predefinit","title":"6. Exemple de servei predefinit","text":"<p>Symfony inclou molts serveis predefinits llestos per a utilitzar, com ara:</p> <ul> <li><code>MailerInterface</code> \u2192 enviar correus electr\u00f2nics  </li> <li><code>LoggerInterface</code> \u2192 registrar missatges de log (errors, avisos, informaci\u00f3...)</li> </ul> <p>Per utilitzar un servei, n\u2019hi ha prou amb injectar-lo al controlador mitjan\u00e7ant el constructor.</p>"},{"location":"Tema4/#61-monolog-servei-de-logs","title":"6.1. Monolog - Servei de logs","text":"<p>Monolog \u00e9s la biblioteca encarregada de gestionar els logs dins d\u2019aplicacions PHP. \u00c9s a dir, \u00e9s l\u2019eina que escriu els missatges en els fitxers, els envia a la consola, a correu, a serveis externs, etc.</p> <p>Aix\u00ed, Monolog proporciona els \u201chandlers\u201d, que s\u00f3n els que decideixen on guardar el missatge:</p> Handler Qu\u00e8 fa StreamHandler Guarda logs en fitxers (<code>var/log/{env}.log</code>) BrowserConsoleHandler Envia logs a la consola del navegador FirePHPHandler Envia logs a l\u2019extensi\u00f3 FirePHP SyslogHandler Envia logs a Syslog (Linux/servidors) SlackWebhookHandler Envia logs a un canal de Slack etc. Hi ha molts m\u00e9s handlers disponibles <p>En Symfony, el handler per defecte \u00e9s <code>StreamHandler</code>:</p> <ul> <li>Si volem modificar el comportament per defecte, cal editar el fitxer de configuraci\u00f3 <code>config/packages/monolog.yaml</code>.</li> </ul> <p>Per aix\u00f2 cal instal\u00b7lar:</p> <pre><code>composer require symfony/monolog-bundle\n</code></pre> <p>Este bundle:</p> <ul> <li>Registra Monolog en Symfony.</li> <li>Configura el sistema de logs</li> <li>Crea autom\u00e0ticament var/log/dev.log quan s\u2019escriu el primer missatge</li> </ul> <p>Veurem un exemple amb <code>LoggerInterface</code> per traure un missatge amb la data i hora de l'acc\u00e9s a la p\u00e0gina inicial.</p> <p>Fitxer: <code>src/Controller/IniciController.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse Psr\\Log\\LoggerInterface;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n\nclass IniciController extends AbstractController\n{\n    public function __construct(private LoggerInterface $logger) {\n\n    }\n\n    #[Route('/', name: 'inici')]\n    public function inici(): Response\n    {\n        $dataHora = new \\DateTime();\n        $this-&gt;logger-&gt;info(\"Acc\u00e9s el \" . $dataHora-&gt;format(\"d/m/Y H:i:s\"));\n        return $this-&gt;render('inici.html.twig');\n    }\n}\n\n?&gt;\n</code></pre> <p>\ud83d\udcdd Notes:</p> <ul> <li><code>\\DateTime</code> \u2192 La barra invertida inicial \\ vol dir \u201ccomen\u00e7a des de l\u2019arrel del namespace\u201d, i DateTime \u00e9s una classe interna de PHP (forma part del nucli del llenguatge).<ul> <li>Tamb\u00e9 podem importar la classe amb <code>use</code> i no utilitzar la <code>\\</code> davant.  </li> </ul> </li> <li>Els missatges es guarden en <code>var/log/dev.log</code> o <code>var/log/prod.log</code> segons l\u2019entorn.</li> <li>Podr\u00edem haver passat directament l'objecte <code>LoggerInterface</code> al m\u00e8tode <code>inici</code>. Per\u00f2 \u00e9s recomanable injectar els serveis al constructor per a poder reutilitzar-los en diversos m\u00e8todes.</li> </ul>"},{"location":"Tema4/#7-exemple-de-servei-propi","title":"7. Exemple de servei propi","text":"<p>Podem crear serveis propis per encapsular funcionalitats o dades reutilitzables dins de l\u2019aplicaci\u00f3.</p> <p>En l\u2019exemple de Contactes, extraurem l\u2019array de contactes del controlador i el posarem en un servei propi anomenat <code>BDProva</code>.</p> <p>Els serveis es poden crear dins de la carpeta <code>src/Service</code>, que cal crear si no existeix. Symfony detecta autom\u00e0ticament totes les classes d\u2019aquesta carpeta com a serveis.</p> <p>Fitxer: <code>src/Service/BDProva.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Service;\n\nclass BDProva\n{\n    private $contactes = array(\n        array(\"codi\" =&gt; 1, \"nom\" =&gt; \"Salvador Sala\",\n              \"telefon\" =&gt; \"638961244\", \"email\" =&gt; \"salvasala@simarro.org\"),\n        array(\"codi\" =&gt; 2, \"nom\" =&gt; \"Anna Llopis\",\n              \"telefon\" =&gt; \"669332004\", \"email\" =&gt; \"annallopis@simarro.org\"),\n        array(\"codi\" =&gt; 3, \"nom\" =&gt; \"Marc Sanchis\",\n              \"telefon\" =&gt; \"962286040\", \"email\" =&gt; \"marcsanchis@simarro.org\"),\n        array(\"codi\" =&gt; 4, \"nom\" =&gt; \"Laura Palop\",\n              \"telefon\" =&gt; \"663568890\", \"email\" =&gt; \"laurapalop@simarro.org\"),\n        array(\"codi\" =&gt; 5, \"nom\" =&gt; \"Sara Sidle\",\n              \"telefon\" =&gt; \"638765434\", \"email\" =&gt; \"sarasidle@simarro.org\"),\n    );\n\n    public function get(): array\n    {\n        return $this-&gt;contactes;\n    }\n}\n\n?&gt;\n</code></pre> <p>Fitxer: <code>src/Controller/ContacteController.php</code></p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse App\\Service\\BDProva;\n\nclass ContacteController extends AbstractController\n{\n    private array $contactes;\n\n    public function __construct(BDProva $dades)\n    {\n        $this-&gt;contactes = $dades-&gt;get();\n    }\n\n    // La resta del controlador (fitxa, buscar...) continua igual\n}\n\n?&gt;\n</code></pre> <p>\ud83d\udcdd Notes:</p> <ul> <li>El servei <code>BDProva</code> s\u2019injecta al constructor de <code>ContacteController</code>.</li> <li>Les dades es guarden en un atribut privat <code>$contactes</code>, accessible per qualsevol m\u00e8tode del controlador.</li> <li>Recorda afegir la l\u00ednia <code>use App\\Service\\BDProva;</code> per importar la classe.</li> <li>Symfony gestiona autom\u00e0ticament aquest servei gr\u00e0cies a l\u2019autowiring (no cal registrar-lo manualment a <code>services.yaml</code>).</li> </ul>"},{"location":"Tema4/#8-altres-opcions","title":"8. Altres opcions","text":"<p>Ara que ja sabem com crear serveis propis i utilitzar-los, o b\u00e9 utilitzar serveis de Symfony o de bundles de tercers, podem veure algunes opcions m\u00e9s avan\u00e7ades que afecten el contenidor de serveis i els serveis que utilitzem.</p>"},{"location":"Tema4/#81-combinar-serveis","title":"8.1. Combinar serveis","text":"<p>Quan en una classe o m\u00e8tode determinat podem necessitar m\u00e9s d\u2019un servei. </p> <p>Tenim dues alternatives:</p> <p>1. Passar diversos serveis al constructor</p> <pre><code>&lt;?php\n\nclass UnaClasse\n{\n    private $contactes;\n    private $logger;\n\n    public function __construct(BDProva $dades, LoggerInterface $logger)\n    {\n        $this-&gt;contactes = $dades-&gt;get();\n        $this-&gt;logger = $logger;\n    }\n}\n\n?&gt;\n</code></pre> <p>2. Crear un servei combinat</p> <p>Podem encapsular els serveis dins d\u2019una classe nova, per exemple <code>ServeiCombinat</code>, i injectar nom\u00e9s aquesta.</p> <pre><code>&lt;?php\n\nclass ServeiCombinat\n{\n    private $contactes;\n    private $logger;\n\n    public function __construct(BDProva $dades, LoggerInterface $logger)\n    {\n        $this-&gt;contactes = $dades-&gt;get();\n        $this-&gt;logger = $logger;\n    }\n\n    // Getters o m\u00e8todes per accedir als serveis interns\n}\n\n?&gt;\n</code></pre> <p>Aleshores, la classe que els necessite nom\u00e9s rebria un objecte d\u2019aquest tipus:</p> <pre><code>&lt;?php\n\nclass UnaClasse\n{\n    private $servei;\n\n    public function __construct(ServeiCombinat $servei)\n    {\n        $this-&gt;servei = $servei;\n    }\n}\n\n?&gt;\n</code></pre> <p>Aquesta segona opci\u00f3 millora la llegibilitat i facilita la reutilitzaci\u00f3 de conjunts de serveis.</p>"},{"location":"Tema4/#82-arguments-sense-autowiring","title":"8.2. Arguments sense \"autowiring\"","text":"<p>L\u2019opci\u00f3 <code>autowire</code> de <code>config/services.yaml</code> permet que Symfony cree autom\u00e0ticament els serveis necessaris en funci\u00f3 del tipus del par\u00e0metre. No obstant aix\u00f2, hi ha casos en qu\u00e8 Symfony no pot autoinjectar valors (p. ex. variables sense tipus o literals).</p> <p>\ud83e\udde9 Exemple</p> <p>Suposem que volem que el format de data siga personalitzable en el <code>IniciController</code>:</p> <pre><code>&lt;?php\n\nnamespace App\\Controller;\n\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Psr\\Log\\LoggerInterface;\nuse DateTime;\n\nclass IniciController extends AbstractController\n{\n\n    public function __construct(private LoggerInterface $log, private $formatData) {\n\n    }\n\n    #[Route('/', name: 'inici')]\n    public function inici(): Response\n    {\n        $dataHora = new DateTime();\n        $this-&gt;log-&gt;info(\"Acc\u00e9s el \" . $dataHora-&gt;format($this-&gt;formatData));\n        return $this-&gt;render('inici.html.twig');\n    }\n}\n\n?&gt;\n</code></pre> <p>Si intentem executar aquesta classe sense definir <code>$formatData</code>, Symfony llan\u00e7ar\u00e0 un error, ja que no sap d\u2019on obtindre aquest valor.</p> <p>\ud83d\udd27 Soluci\u00f3:</p> <p>Definir l\u2019argument al final del fitxer <code>services.yaml</code>:</p> <pre><code>  App\\Controller\\IniciController:\n    arguments:\n      $formatData: 'd/m/y H:i:s'\n</code></pre> <p>Amb aix\u00f2, indiquem que el par\u00e0metre <code>$formatData</code> del constructor de <code>IniciController</code> tindr\u00e0 per defecte el valor <code>'d/m/y H:i:s'</code>.</p> <p>\ud83d\udcdd Notes:</p> <ul> <li>No utilitzes el tabulador per indentar (usa espais).  </li> <li>Aquesta t\u00e8cnica permet definir par\u00e0metres personalitzats per a serveis que Symfony no pot autowirejar autom\u00e0ticament.</li> </ul>"},{"location":"Tema4/#83-parametres-globals","title":"8.3. Par\u00e0metres globals","text":"<p>Es poden definir par\u00e0metres de configuraci\u00f3 globals per a tots els serveis dins de la secci\u00f3 <code>parameters</code> de <code>config/services.yaml</code>. Aquests valors poden ser reutilitzats en qualsevol servei o part de l\u2019aplicaci\u00f3.  </p> <pre><code>parameters:\n  locale: 'ca'\n  app.nom_projecte: 'Gestor de Contactes'\n  app.suport_email: '%env(SUPPORT_EMAIL)%'\n  format_data_defecte: 'd/m/y H:i:s'\n\n...\n\nApp\\Controller\\IniciController:\n  arguments:\n      $formatData: '%format_data_defecte%'\n      $suportEmail: '%app.suport_email%'\n</code></pre> <p>I en <code>.env</code> podem definir les variables:</p> <pre><code>SUPPORT_EMAIL=suport@exemple.com\n</code></pre> <p>Al codi PHP:</p> <pre><code>&lt;?php\n\npublic function __construct(private string $suportEmail)\n{\n    // Symfony injecta autom\u00e0ticament el valor de l'entorn\n}\n\n?&gt;\n</code></pre> <p>Tamb\u00e9 pots accedir-hi via el contenidor:</p> <pre><code>$suport = $this-&gt;getParameter('app.suport_email');\n</code></pre>"},{"location":"Tema4/#9-resum-final","title":"9. Resum final","text":"Conceptes clau Descripci\u00f3 Servei Classe que realitza una tasca concreta. Un servei = una tasca. Contenidor de serveis Sistema que crea i gestiona tots els serveis. Autowiring Symfony detecta i injecta serveis autom\u00e0ticament. Autoconfigure Afegeix configuraci\u00f3 autom\u00e0tica segons el tipus. Par\u00e0metres i entorn Permeten definir configuracions globals o secretes. Bones pr\u00e0ctiques Injecci\u00f3 per constructor, serveis privats, i codi desacoblat. <p>Refer\u00e8ncies \u00fatils</p> <ul> <li>Documentaci\u00f3 oficial de Symfony 7</li> <li>Dependency Injection</li> <li>Best Practices: Service Design</li> </ul>"},{"location":"Tema5/","title":"\ud83d\udcd8 Tema 5 \u2014 Model de dades amb Doctrine","text":""},{"location":"Tema5/#1-introduccio-a-doctrine","title":"1. Introducci\u00f3 a Doctrine","text":""},{"location":"Tema5/#11-que-es-un-orm","title":"1.1 Qu\u00e8 \u00e9s un ORM?","text":"<p>Un ORM (Object Relational Mapping) \u00e9s un sistema que permet treballar amb bases de dades relacionals utilitzant objectes. Doctrine \u00e9s l\u2019ORM m\u00e9s utilitzat amb Symfony. Gr\u00e0cies a ell:</p> <ul> <li>Podem connectar-nos a una base de dades relacional (MySQL, MariaDB, PostgreSQL, etc.).</li> <li>Les taules i columnes es mapegen autom\u00e0ticament amb classes i atributs PHP.</li> <li>Ens abstrau del gestor de base de dades concret, ja que tot es fa a trav\u00e9s d\u2019objectes.</li> </ul> <p>Avantatge principal: </p> <ul> <li>A\u00efllar l\u2019aplicaci\u00f3 del gestor de base de dades (MySQL, Oracle, PostgreSQL...). Symfony treballa amb objectes, i Doctrine s\u2019encarrega de convertir-los a registres SQL o viceversa.</li> </ul>"},{"location":"Tema5/#12-configuracio-basica","title":"1.2 Configuraci\u00f3 b\u00e0sica","text":"<p>Doctrine utilitza el fitxer <code>.env</code> per a definir la connexi\u00f3 amb la base de dades. </p> <p>L'estructura general ser\u00e0 aquesta: <pre><code>DATABASE_URL=mysql://db_user:db_password@127.0.0.1:3306/db_name\n</code></pre></p> <p>Exemple:</p> <pre><code>DATABASE_URL=\"mysql://root@127.0.0.1:3306/daw_agenda\"\n</code></pre> <p>Despr\u00e9s, podem crear la base de dades amb la comanda:</p> <pre><code>php bin/console doctrine:database:create\n</code></pre> <p>Aquesta comanda llegir\u00e0 la variable <code>DATABASE_URL</code> i crear\u00e0 la base de dades indicada.</p> <p>\u26a0\ufe0f Atenci\u00f3: No s\u2019ha de pujar l\u2019arxiu <code>.env</code> al repositori, ja que cont\u00e9 dades sensibles (usuaris, contrasenyes\u2026).</p>"},{"location":"Tema5/#2-entitats","title":"2. Entitats","text":"<p>Una entitat \u00e9s una classe PHP que representa una taula de la base de dades.</p> <p>Exemple d\u2019entitat: <code>Contacte</code> amb atributs <code>id</code>, <code>nom</code>, <code>telefon</code> i <code>email</code>.</p>"},{"location":"Tema5/#21-crear-entitats","title":"2.1. Crear Entitats","text":"<p>Per a la creaci\u00f3 d'entitat utilitzem la seg\u00fcent instrucci\u00f3:</p> <pre><code>php bin/console make:entity\n</code></pre> <p>L\u2019assistent et demanar\u00e0:</p> <ul> <li>Nom de la classe</li> <li>Propietats del atributs: nom, tipus, tamany, si poden ser nuls o no</li> </ul> <p>Exemple d\u2019execuci\u00f3:</p> <pre><code>Class name of the entity to create or update:\n &gt; Contacte\nNew property name:\n &gt; nom\nField type:\n &gt; string\nField length [255]:\n &gt; 255\nCan this field be null in the database? [no]:\n &gt; no\n</code></pre> <p>Com a resultat, generar\u00e0 el codi corresponent a la seg\u00fcent classe:</p> <p>Fitxer: <code>src/Entity/Contacte.php</code> <pre><code>&lt;?php\n\nnamespace App\\Entity;\n\nuse App\\Repository\\ContacteRepository;\nuse Doctrine\\ORM\\Mapping as ORM;\n\n#[ORM\\Entity(repositoryClass: ContacteRepository::class)]\nclass Contacte\n{\n    #[ORM\\Id]\n    #[ORM\\GeneratedValue]\n    #[ORM\\Column]\n    private ?int $id = null;\n\n    #[ORM\\Column(length: 255)]\n    private ?string $nom = null;\n\n    #[ORM\\Column(length: 15)]\n    private ?string $telefon = null;\n\n    #[ORM\\Column(length: 255)]\n    private ?string $email = null;\n\n    // Getters i setters\n}\n\n?&gt;\n</code></pre></p> <p>El camp codi que abans utilitzavem com a identificador s\u2019ha substitu\u00eft per un id autonum\u00e8ric que Doctrine genera autom\u00e0ticament com a clau principal. Aix\u00ed, nom\u00e9s cal definir els altres camps (nom, tel\u00e8fon i email) amb el seu tipus corresponent.</p> <p>Symfony</p> <p>L\u2019execuci\u00f3 de la instrucci\u00f3 genera autom\u00e0ticament les seg\u00fcents classes:</p> <ul> <li>El fitxer de l\u2019entitat en <code>src/Entity/Contate.php</code>.</li> <li>El seu repositori en <code>src/Repository/ContacteRepository.php</code> (si no existia).</li> </ul> <p>Recorda no es modifica la base de dades. Per aplicar els canvis al esquema cal generar i executar la migraci\u00f3, tal com explicarem en l\u2019apartat seg\u00fcent.</p> <p>Els tipus de dades m\u00e9s habituals en Doctrine s\u00f3n:</p> <ul> <li>string (text amb longitud limitada)</li> <li>text (text llarg)</li> <li>integer (enter)</li> <li>boolean (cert/fals)</li> <li>float (nombre real)</li> <li>date, time, datetime (dates i hores).</li> </ul>"},{"location":"Tema5/#22-editar-entitats","title":"2.2. Editar Entitats","text":"<p>Si despr\u00e9s de crear una entitat volem canviar-ne l\u2019estructura, podem editar la classe manualment o tornar a executar <code>php bin/console make:entity</code>, indicant el mateix nom d\u2019entitat per afegir nous camps.</p> <p>Una vegada fets els canvis, cal generar i executar una nova migraci\u00f3 perqu\u00e8 Doctrine actualitze la base de dades amb la nova estructura.</p>"},{"location":"Tema5/#23-establir-claus-primaries","title":"2.3. Establir claus prim\u00e0ries","text":"<p>Per defecte, Doctrine crea autom\u00e0ticament un camp <code>id</code> autonum\u00e8ric com a clau prim\u00e0ria.  </p> <p>Si volem utilitzar un altre camp com a identificador, hem de seguir aquests passos:</p> <ol> <li>Eliminar l\u2019atribut <code>id</code> i el seu getter de l\u2019entitat.  </li> <li>Afegir l\u2019anotaci\u00f3 seg\u00fcent al camp que volem usar com a clau prim\u00e0ria:</li> </ol> <pre><code>#[ORM\\Id]\nprivate $nomCamp;\n</code></pre> <ul> <li>Si la clau \u00e9s composta (format per diversos camps), afegirem aquesta anotaci\u00f3 a cadascun d\u2019ells.</li> </ul> <p>Finalment, cal generar i aplicar una nova migraci\u00f3 perqu\u00e8 la base de dades s\u2019actualitze.</p>"},{"location":"Tema5/#3-actualitzar-la-base-de-dades","title":"3. Actualitzar la base de dades","text":"<p>Una vegada definida l\u2019entitat o les seues modificacions, \u00e9s necessari sincronitzar els canvis amb la base de dades perqu\u00e8 l\u2019estructura (taules, columnes, relacions...) coincidisca amb el model definit al projecte.</p> <p>El flux de treball habitual \u00e9s el seg\u00fcent:</p> <p>Comandes:</p> <pre><code># 1. Comprovar les difer\u00e8ncies entre entitats i base de dades\nphp bin/console doctrine:schema:validate\n\n# 2. Genera un fitxer de migraci\u00f3 amb els canvis detectats\nphp bin/console make:migration\n\n# 3. Aplica (i registra) les migracions pendents\nphp bin/console doctrine:migrations:migrate\n</code></pre> <p>Aquest proc\u00e9s crea o modifica les taules que corresponen a les entitats del projecte de manera controlada i reversible.</p>"},{"location":"Tema5/#4-funcionament-intern","title":"4. Funcionament intern","text":"<p>Per comprendre b\u00e9 el funcionament, primer necessitem con\u00e9ixer tres components b\u00e0sics que Doctrine utilitza internament.</p> <ul> <li> <p>ManagerRegistry: \u00e9s el punt central de connexi\u00f3 que sap quins gestors hi ha disponibles i com accedir (com la centraleta de Doctrine).</p> <ul> <li>Serveix per obtindre l\u2019EntityManager adequat. En la majoria de projectes nom\u00e9s hi ha un, per\u00f2 aquest servei permetria gestionar diversos gestors de base de dades.</li> </ul> </li> <li> <p>EntityManager: \u00e9s el gestor d\u2019entitats.</p> <ul> <li>S\u2019encarrega de les operacions d\u2019escriptura i gesti\u00f3 del cicle de vida de les entitats:<ul> <li>Sap com guardar, modificar, eliminar de la base de dades.</li> <li>Tamb\u00e9 permet accedir a buscar informaci\u00f3, mitjan\u00e7ant el repositori de cada entitat.<ul> <li>Repositori: \u00e9s una classe especialitzada a obtenir entitats d'un tipus concret.</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"Tema5/#41-com-es-relacionen","title":"4.1. Com es relacionen","text":"Element Rol Analogia S\u2019obt\u00e9 de Exemple ManagerRegistry Punt d\u2019acc\u00e9s central als EntityManagers \u260e\ufe0f Centraleta de gestors S\u2019injecta autom\u00e0ticament <code>getManager()</code>, <code>getManagerForClass()</code> EntityManager Gestiona el cicle de vida de les entitats \ud83e\uddf0 L\u2019encarregat del magatzem <code>ManagerRegistry-&gt;getManager()</code> <code>persist()</code>, <code>flush()</code>, <code>remove()</code> Repository Busca i recupera entitats concretes \ud83d\udcd7 Cat\u00e0leg o venedor <code>EntityManager-&gt;getRepository()</code> <code>find()</code>, <code>findBy()</code>, <code>findAll()</code>"},{"location":"Tema5/#42-resum-visual","title":"4.2. Resum visual","text":"<pre><code>ManagerRegistry\n     \u2502\n     \u2514\u2500\u2500&gt; EntityManager\n              \u2502\n              \u251c\u2500\u2500 persist(), flush(), remove()\n              \u2514\u2500\u2500&gt; Repository (per entitat)\n                        \u251c\u2500\u2500 find(), findBy()\n                        \u2514\u2500\u2500 m\u00e8todes personalitzats (createQueryBuilder)\n</code></pre> <p>Symfony</p> <p>En els nostres projectes nom\u00e9s tenim una base de dades i un \u00fanic gestor, per aix\u00f2 injectem directament EntityManagerInterface, que \u00e9s m\u00e9s simple i net.</p> <p>No necessitem cridar <code>$registry-&gt;getManager()</code> perqu\u00e8 no hi ha cap dubte sobre quin manager s\u2019ha d\u2019utilitzar.</p>"},{"location":"Tema5/#5-persistir-objectes","title":"5. Persistir objectes","text":"<p>L\u2019EntityManager \u00e9s el component encarregat de gestionar el cicle de vida de les entitats, \u00e9s a dir, les operacions que afecten directament la base de dades: inserir, modificar o eliminar registres.</p> <p>Per a poder utilitzar-lo en un controlador, s\u2019ha d\u2019injectar la interf\u00edcie <code>EntityManagerInterface</code>, que proporciona els m\u00e8todes necessaris per a treballar amb les entitats, com ara <code>persist()</code>, <code>remove()</code> o <code>flush()</code>.</p>"},{"location":"Tema5/#51-guardar","title":"5.1. Guardar","text":"<p>Exemple dins d'un m\u00e8tode al controlador:</p> <pre><code>&lt;?php\n\nuse App\\Entity\\Contacte;\nuse Doctrine\\ORM\\EntityManagerInterface;\n\n\nclass ContacteController extends AbstractController\n{\n    ...\n\n    #[Route('/contacte/afegir', name: 'afegir_contacte')]\n    public function afegir(EntityManagerInterface $gestor)\n    {\n        $contacte = new Contacte();\n        $contacte-&gt;setNom(\"Juan Cuesta\");\n        $contacte-&gt;setTelefon(\"659231544\");\n        $contacte-&gt;setEmail(\"juan@simarro.org\");\n\n        // Indiquem que volem guardar aquest objecte\n        $gestor-&gt;persist($contacte);\n\n        // S\u2019executa la inserci\u00f3\n        $gestor-&gt;flush();\n\n        return new Response(\"Contacte \" . $contacte-&gt;getId() . \" guardat.\");\n    }\n\n    ...\n\n?&gt;\n</code></pre> <p>\ud83d\udcdd Notes:</p> <ul> <li>\u00c9s important col\u00b7locar el controlador d\u2019inserci\u00f3 abans del de cerca, perqu\u00e8 si no, en accedir a la ruta <code>/contacte/inserir</code>, Symfony podria interpretar \u201cinserir\u201d com un par\u00e0metre del controlador de cerca i executar-lo per error.</li> </ul>"},{"location":"Tema5/#52-modificar","title":"5.2. Modificar","text":"<pre><code>&lt;?php\n\n$contacte = $this-&gt;repositori-&gt;find($id);\n$contacte-&gt;setTelefon(\"600000000\");\n$gestor-&gt;flush();\n\n?&gt;\n</code></pre>"},{"location":"Tema5/#53-eliminar","title":"5.3. Eliminar","text":"<pre><code>&lt;?php\n\n$contacte = $this-&gt;repositori-&gt;find($id);\n$gestor-&gt;remove($contacte);\n$gestor-&gt;flush();\n\n?&gt;\n</code></pre>"},{"location":"Tema5/#54-captura-errors","title":"5.4. Captura errors","text":"<p>Si es produeix un error durant la inserci\u00f3 (si algun camp obligatori \u00e9s nul o es duplica una clau prim\u00e0ria), el m\u00e8tode <code>flush()</code> llan\u00e7ar\u00e0 una excepci\u00f3.  </p> <p>Per evitar que l\u2019aplicaci\u00f3 es trenque, podem capturar l\u2019excepci\u00f3 i mostrar una resposta controlada a l\u2019usuari:</p> <pre><code>&lt;?php\n\n$gestor-&gt;persist($objecte);\n\ntry {\n    $gestor-&gt;flush();\n    return new Response(\"Objecte guardat\");\n} catch (\\Exception $e) {\n    return new Response(\"Error guardant objecte: \" . $e-&gt;getMessage());\n}\n\n?&gt;\n</code></pre> <p>Aix\u00f2 garanteix un tractament d\u2019errors segur i evita que es mostren missatges interns del servidor.</p>"},{"location":"Tema5/#6-consultar-objectes","title":"6. Consultar objectes","text":"<p>Doctrine crea autom\u00e0ticament una classe de repositori per a cada entitat (per exemple, ContacteRepository). Aquesta classe hereta de <code>ServiceEntityRepository</code> i permet:</p> <ul> <li>Recuperar dades.</li> <li>Fer cerques personalitzades.</li> <li>Accedir a l\u2019EntityManager per fer canvis.</li> </ul> <p>Per a poder fer consultes a la nostra base de dades, s\u2019ha d\u2019injectar al controlador la interf\u00edcie <code>EntityManagerInterface</code>, que ens permet obtindre el repositori de qualsevol entitat i accedir a les seues dades.</p> <p>En Symfony \u00e9s una molt bona pr\u00e0ctica injectar l\u2019EntityManagerInterface en el constructor. Aix\u00f2 et permet tindre disponible l\u2019entity manager en tots els m\u00e8todes del controlador.</p> <p>Si tenim una entitat <code>Contacte</code>, podem obtindre el seu repositori per fer consultes aix\u00ed:</p> <pre><code>&lt;?php\n\nclass ContacteController extends AbstractController\n{\n    private $repositori;\n\n    // Injecci\u00f3 de depend\u00e8ncia al constructor\n    public function __construct(private EntityManagerInterface $gestor)\n    {\n        // Inst\u00e0ncia \u00fanica del repositori de Contacte\n        $this-&gt;repositori = $this-&gt;gestor-&gt;getRepository(Contacte::class);\n    }\n\n    // A partir d'ac\u00ed, qualsevol m\u00e8tode pot utilitzar:\n    // \u2192 $this-&gt;gestor     \u2192 per a persistir, modificar o eliminar\n    // \u2192 $this-&gt;repositori \u2192 per a fer consultes sobre Contacte\n\n    ...\n\n}\n\n?&gt;\n</code></pre> <p>Una vegada tenim el repositori, podem utilitzar diferents m\u00e8todes de consulta.</p> <ul> <li> <p>M\u00e8tode <code>find()</code></p> <p>Localiza un objecte per la clau prim\u00e0ria (normalment l\u2019id) que se li passa com a par\u00e0metre.</p> <pre><code>$contacte = $this-&gt;repositori-&gt;find(1);\n</code></pre> <p>\u27a1\ufe0f Aquesta instrucci\u00f3 buscar\u00e0 el contacte amb id = 1.</p> </li> <li> <p>M\u00e8tode <code>findOneBy()</code></p> <p>Localitza un \u00fanic objecte que complisca els criteris de cerca passats com a par\u00e0metre (en forma d\u2019array associatiu).</p> <pre><code>$contacte = $this-&gt;repositori-&gt;findOneBy([\"telefon\" =&gt; \"687908070\"]);\n</code></pre> <p>\u27a1\ufe0f Aquesta consulta busca el contacte el tel\u00e8fon del qual siga \"687908070\".</p> <p>Si volem indicar m\u00e9s d\u2019un criteri, podem afegir-los a l\u2019array:</p> <pre><code>$contacte = $this-&gt;repositori-&gt;findOneBy([\n    \"nom\" =&gt; \"Laura\",\n    \"email\" =&gt; \"laura@gmail.com\"\n]);\n</code></pre> </li> <li> <p>M\u00e8tode <code>findBy()</code></p> <p>Localitza tots els objectes que complisquen els criteris passats com a par\u00e0metre. Retorna un array d\u2019objectes.</p> <pre><code>$contactes = $this-&gt;repositori-&gt;findBy([\"comarca\" =&gt; \"La Costera\"]);\n</code></pre> <p>\u27a1\ufe0f Retorna un array amb tots els contactes que pertanyen a la comarca \u201cLa Costera\u201d.</p> <p>Tamb\u00e9 es pot afegir ordre i l\u00edmit als resultats:</p> <pre><code>$contactes = $this-&gt;repositori-&gt;findBy(\n    [\"comarca\" =&gt; \"La Costera\"],\n    [\"nom\" =&gt; \"ASC\"], // ordre ascendent pel nom\n    10,               // m\u00e0xim 10 resultats\n    0                 // des de l\u2019\u00edndex 0\n);\n</code></pre> </li> <li> <p>M\u00e8tode <code>findAll()</code></p> <p>Recupera tots els objectes de la taula corresponent a l\u2019entitat.</p> <pre><code>$contactes = $this-&gt;repositori-&gt;findAll();\n</code></pre> <p>\u27a1\ufe0f Retorna un array amb tots els contactes existents en la base de dades.</p> </li> </ul>"},{"location":"Tema5/#61-exemple-complet-en-un-controlador","title":"6.1. Exemple complet en un controlador","text":"<pre><code>&lt;?php\n\n# Al constructor hem injectat EntityManagerInterface com a $gestor\n\n#[Route('/contacte/{codi}', name:'fitxa_contacte', requirements: ['codi' =&gt; '\\d+'])]\npublic function fitxa(int $codi)\n{\n    // 1) Buscar el contacte pel codi\n    $contacte = $this-&gt;repositori-&gt;find($codi);\n\n    if ($contacte)\n        return $this-&gt;render('contacte/fitxa.html.twig', [\n            'contacte' =&gt; $contacte,\n            'codi' =&gt; $codi\n        ]);\n    else\n        return $this-&gt;render('contacte/fitxa.html.twig', [\n            'contacte' =&gt; null,\n            'codi' =&gt; $codi\n        ]);\n}\n\n?&gt;\n</code></pre> <p>En aquest exemple, el controlador accedeix al repositori de Contacte i recupera un objecte segons el seu id. Si el troba, renderitza la plantilla fitxa.html.twig amb les dades del contacte; en cas contrari, envia el contacte buit.</p>"},{"location":"Tema5/#62-consultes-avancades-querybuilder","title":"6.2. Consultes avan\u00e7ades (QueryBuilder)","text":"<p>Els m\u00e8todes anteriors permeten buscar per igualtat directa. Si volem fer cerques parcials o condicionals, podem afegir m\u00e8todes personalitzats al repositori utilitzant el QueryBuilder de Doctrine.</p> <p>Exemple 1: buscar contactes pel nom</p> <p>Fitxer: <code>src/Repository/ContacteRepository.php</code></p> <pre><code>&lt;?php\n\npublic function findByName($text): array\n{\n    $qb = $this-&gt;createQueryBuilder('c')\n        -&gt;andWhere('c.nom LIKE :text')\n        -&gt;setParameter('text', '%' . $text . '%')\n        -&gt;getQuery();\n\n    return $qb-&gt;execute();\n}\n\n?&gt;\n</code></pre> <p>\u27a1\ufe0f Aquesta consulta retornar\u00e0 tots els contactes el nom dels quals continga el text indicat.</p> <p>I podem cridar-la des del controlador:</p> <pre><code>&lt;?php\n\n# Al constructor hem:\n# - Injectat EntityManagerInterface.\n# - Asignat el repositori.\n\n#[Route('/contacte/{text}', name: 'buscar_contacte', requirements: ['text' =&gt; '[a-zA-Z]+'])]\npublic function buscar(string $text): Response\n{\n    // 1) Filtrar pel m\u00e8tode creat al repositori\n    $resultat = $this-&gt;repositori-&gt;findByName($text);\n\n    // 2) Passar la llista (pot ser buida) a la vista\n    return $this-&gt;render('contacte/cerca.html.twig', [\n        'text' =&gt; $text,\n        'resultats' =&gt; $resultat\n    ]);\n}\n\n?&gt;\n</code></pre> <p>Aquest controlador permet buscar contactes pel nom introdu\u00eft en la URL, utilitzant la consulta definida al repositori. Despr\u00e9s envia els resultats a una vista llista_contactes.html.twig per a mostrar-los.</p> <p>Exemple 2: buscar contactes majors d'una certa edat</p> <p>Fitxer: <code>src/Repository/ContacteRepository.php</code></p> <pre><code>&lt;?php\n\npublic function findByEdatMajorQue(int $edat): array\n{\n    $qb = $this-&gt;createQueryBuilder('p')\n        -&gt;andWhere('p.edat &gt; :edat')\n        -&gt;setParameter('edat', $edat)\n        -&gt;getQuery();\n\n    return $qb-&gt;execute();\n}\n\n?&gt;\n</code></pre> <p>Laboratori</p> <p>Aquesta consulta no funcionar\u00e0 al projecte actual perqu\u00e8 l'entitat Contacte no t\u00e9 definit el camp edat.</p>"},{"location":"Tema5/#63-altres-formes","title":"6.3. Altres formes","text":"<p>A m\u00e9s d\u2019emprar el <code>QueryBuilder</code> o els m\u00e8todes per defecte del repositori (<code>find</code>, <code>findOneBy</code>, <code>findBy</code>, etc.), Doctrine permet realitzar consultes mitjan\u00e7ant dues alternatives addicionals:</p> <ul> <li>DQL (Doctrine Query Language): llenguatge similar a SQL per\u00f2 orientat a entitats en lloc de taules.</li> <li>SQL natiu: permet escriure consultes directament en SQL quan necessitem m\u00e0xim control o optimitzaci\u00f3.</li> </ul>"},{"location":"Tema5/#7-relacions-entre-entitats","title":"7. Relacions entre entitats","text":"<p>Fins ara, hem treballat amb operacions centrades en una sola entitat (taula).  </p> <p>Aquesta secci\u00f3 explica com gestionar i operar amb m\u00e9s d'una entitat que estan relacionades entre si en la base de dades.</p> <p>Hi ha dos tipus principals de relacions entre entitats:</p> Tipus de Relaci\u00f3 Descripci\u00f3 Implementaci\u00f3 Molts a Un (Many-to-One) Engloba les relacions Un a Molts, Molts a Un i Un a Un. Es reflecteix afegint una Clau Aliena (Foreign Key) en una de les entitats que referencia l'altra. Molts a Molts (Many-to-Many) Una entitat es pot relacionar amb m\u00faltiples inst\u00e0ncies de l'altra, i viceversa. Requereix una Taula Addicional (taula pivot/d\u2019uni\u00f3) per emmagatzemar la relaci\u00f3 entre els IDs de les dues entitats. <p>Exemples:</p> Tipus de relaci\u00f3 Exemple Anotaci\u00f3 OneToOne Persona \u2194 Passaport <code>#[ORM\\OneToOne]</code> OneToMany / ManyToOne Comarca \u2194 Poblaci\u00f3 <code>#[ORM\\OneToMany]</code>, <code>#[ORM\\ManyToOne]</code> ManyToMany Alumne \u2194 Assignatura <code>#[ORM\\ManyToMany]</code>"},{"location":"Tema5/#71-relacio-molts-a-un-manytoone","title":"7.1. Relaci\u00f3 Molts a Un (<code>ManyToOne</code>)","text":"<p>Com a exemple pr\u00e0ctic, crearem una relaci\u00f3 Molts a Un entre l'entitat <code>Contacte</code> i una nova entitat <code>Comarca</code> (un contacte pertany a una comarca, i una comarca pot tenir molts contactes).</p> <p>Pas 1. Creaci\u00f3 de l'Entitat <code>Comarca</code></p> <p>Primer, generem l'entitat amb un ID autogenerat i un camp <code>nom</code>.</p> <pre><code>php bin/console make:entity\n\n&gt; Comarca\n# ... Afegir el camp 'nom' com a string (255, no nullable)\n</code></pre> <p>Despr\u00e9s, creem la taula <code>Comarca</code> a la base de dades mitjan\u00e7ant una migraci\u00f3:</p> <pre><code># 1. Genera un fitxer de migraci\u00f3 amb els canvis detectats\nphp bin/console make:migration\n\n# 2. Aplica (i registra) les migracions pendents\nphp bin/console doctrine:migration:migrate\n</code></pre> <p>Pas 2. Afegir la Relaci\u00f3 a l'Entitat <code>Contacte</code></p> <p>Editem l'entitat <code>Contacte</code> per afegir-li el camp de relaci\u00f3 <code>comarca</code>:</p> <pre><code>php bin/console make:entity\n\n&gt; Contacte\n# ...\nNew property name:\n&gt; comarca\nField type:\n&gt; relation\nWhat class should this entity be related to?:\n&gt; Comarca\nRelation type?:\n&gt; ManyToOne\nIs the Contacte.comarca property allowed to be null (nullable)?:\n&gt; no\nDo you want to add a new property to Comarca...?:\n&gt; no\n</code></pre> <p>Aix\u00f2 afegeix un atribut a l'entitat <code>Contacte</code> com el seg\u00fcent:</p> <pre><code>&lt;?php\n\n#[ORM\\ManyToOne]\n#[ORM\\JoinColumn(nullable: false)]\nprivate ?Comarca $comarca = null;\n\n?&gt;\n</code></pre> <p>Pas 3. Actualitzaci\u00f3 de la Base de Dades</p> <p>Despr\u00e9s de fer els canvis, tornem a generar i executar la migraci\u00f3:</p> <p>\u26a0\ufe0f Si hi ha registres de <code>Contacte</code> sense <code>Comarca</code>, cal eliminar-los o afegir-los abans per evitar errors de clau aliena.</p> <pre><code># 1. Genera un fitxer de migraci\u00f3 amb els canvis detectats\nphp bin/console make:migration\n\n# 2. Aplica (i registra) les migracions pendents\nphp bin/console doctrine:migration:migrate\n</code></pre> <p>Aix\u00f2 afegeix la clau aliena <code>comarca_id</code> a la taula <code>contacte</code>.</p> <p>Pas 4. Treballar amb Entitats Relacionades</p> <p>Una vegada les entitats estan relacionades, podem fer operacions d\u2019inserci\u00f3 i de cerca.</p> <p>- Inserci\u00f3 d\u2019Entitats Relacionades</p> <ul> <li> <p>Si la <code>Comarca</code> no existeix:</p> <ol> <li>Es creen els objectes <code>Comarca</code> i <code>Contacte</code>.  </li> <li>S\u2019estableix la relaci\u00f3:    <pre><code>$contacte-&gt;setComarca($comarca);\n</code></pre></li> <li>Es persisteixen ambd\u00f3s objectes i es crida a <code>flush()</code>.</li> </ol> </li> <li> <p>Si la <code>Comarca</code> ja existeix:</p> <ol> <li>Es cerca l'objecte <code>Comarca</code> existent:    <pre><code>$comarca = $this-&gt;repositori-&gt;find(1);\n</code></pre></li> <li>Es crea un nou <code>Contacte</code>.  </li> <li>S\u2019estableix la relaci\u00f3 amb l\u2019objecte <code>Comarca</code>.  </li> <li>Es persisteix el <code>Contacte</code> i s\u2019executa <code>flush()</code>.</li> </ol> </li> </ul> <p>- Cerca d\u2019Entitats Relacionades</p> <p>L\u2019acc\u00e9s a les dades de l\u2019entitat relacionada \u00e9s directe des de l\u2019entitat principal:</p> <pre><code>&lt;?php\n\n// Obtenim l'objecte Contacte amb ID = 1\n$contacte = $this-&gt;repositori-&gt;find(1);\n\n// Accedim a l'objecte Comarca relacionat i al seu nom\n$nomComarca = $contacte-&gt;getComarca()-&gt;getNom();\n\n?&gt;\n</code></pre> <p>\ud83d\udca1 Nota (Lazy Loading): Doctrine no recupera les dades de <code>Comarca</code> fins que no s\u2019accedeix efectivament a elles (per exemple, quan s\u2019executa <code>$contacte-&gt;getComarca()</code>).</p> <p>Laboratori</p> <p>Modifica el men\u00fa principal de l'aplicaci\u00f3 perqu\u00e8 incloga les opcions seg\u00fcents, totes operatives:</p> <ul> <li>Inici: ha d'enlla\u00e7ar amb la ruta principal de l'aplicaci\u00f3 i mostrar la p\u00e0gina d'inici.</li> <li>Contacte: mostra la fitxa d\u2019un contacte concret, utilitzant un identificador fix. En aquesta fitxa s'ha de visualitzar tota la informaci\u00f3 disponible del contacte, incloent-hi el nom de la seua Comarca.</li> <li>Llistar: mostra un llistat de tots els contactes registrats en la base de dades. La informaci\u00f3 pot apar\u00e9ixer resumida (nom, tel\u00e8fon).</li> <li>Afegir: permet inserir un nou contacte utilitzant un formulari Symfony. L\u2019alta ha d\u2019incloure tamb\u00e9 la selecci\u00f3 de la comarca relacionada.</li> </ul>"},{"location":"Tema5/#8-recursos-i-documentacio","title":"8. Recursos i documentaci\u00f3","text":"<ul> <li> <p>Documentaci\u00f3 oficial de Doctrine ORM \ud83d\udc49 https://symfony.com/doc/current/doctrine.html</p> </li> <li> <p>Documentaci\u00f3 d\u2019anotacions i tipus de dades \ud83d\udc49 https://www.doctrine-project.org/projects/doctrine-orm/en/current/reference/basic-mapping.html</p> </li> </ul>"},{"location":"templates/","title":"Plantilla per copiar","text":"<p>Warning: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>Example: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>Tip: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>Important: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>Danger: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>Note: Atenci\u00f3 amb les rutes amigables</p> <p>Recordar repetir aquestes instruccions en tots els projectes Symfony que utilitzen rutes amigables.</p> <p>\ud83e\udde0 Explicaci\u00f3 del funcionament</p> <ul> <li>...</li> <li>...</li> </ul> <p>\u26a0\ufe0f Si ...</p> <p>\ud83d\udca1 En ...</p> <p>\ud83d\udcdd Notes:</p> <ul> <li>...</li> <li>...</li> </ul> <p>Fitxer: <code>base.html.twig</code></p> <p>Fitxer (<code>base.html.twig</code>)</p> <p>\u2192</p>"}]}